close all
clear all
clc

fontSize=14;

% Nx=21;
% Ny=21;

Dn=load('D/D_0.txt');
Da=load('D/D_1.txt');
%Ds=load('D/D_2.txt');

% d1n=reshape(Dn(:,4),Nx,Ny);
% d2n=reshape(Dn(:,5),Nx,Ny);
% d3n=reshape(Dn(:,6),Nx,Ny);
% 
% X=reshape(Da(:,1),Nx,Ny);
% Y=reshape(Da(:,2),Nx,Ny);
% d1a=reshape(Da(:,4),Nx,Ny);
% d2a=reshape(Da(:,5),Nx,Ny);
% d3a=reshape(Da(:,6),Nx,Ny);


origin=find(~isfinite(Da(:,4)));
Da(origin,[4:6])=0;
%Da(origin,[4:6])=0;

df=1;
useOffset=0;

offX=mean(Da(:,4)-Dn(:,4))
offY=mean(Da(:,5)-Dn(:,5))

figure(1)
clf
plot(Da(:,1)+df*Da(:,4),Da(:,2)+df*Da(:,5),'o')
hold on
plot(Dn(:,1)+df*(Dn(:,4)+offX*useOffset),Dn(:,2)+df*(Dn(:,5)+offY*useOffset),'rx')
axis equal 
grid on
xlabel('x_1 / b','Fontsize',fontSize)
ylabel('x_2 / b','Fontsize',fontSize)
legend('analytical','numerical')
set(gca,'FontSize',fontSize)

figure(2)
plot(Da()Da(:,5)-Dn(:,5))