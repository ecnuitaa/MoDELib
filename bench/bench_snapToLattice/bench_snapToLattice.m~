clear all
close all
clc

crystal=1

switch crystal
    case 1 % BCC
A=[ 1 -1  1;
    1  1 -1;
   -1  1  1]/2;

N =[ 1 -1   1 -1  0  0;
     1  1   0  0  1 -1;
     0  0   1  1  1  1];

    case 2 % FCC
A=[1 0 1;
   1 1 0;
   0 1 1]/2;

N =[-1    1   -1    1;
     1   -1   -1    1;
    -1   -1    1    1];
end

%% compute direction
invA=inv(A)

n=invA*N

D=cross(N(:,2),N(:,3));
d=invA*D
gd=gcd(d(1),gcd(d(2),d(3)));
d=d/gd
D=A*d
