%clear all
%close all
%clc
function main
clc
[t,x]=ode45(@overDamped,[0 100],5);
figure(1)
plot(x,t,'o')

function xDot=overDamped(t,x) 
B=1;
b=[-1,0,0]';
%xi=;
f=pkForce([x,0,0],b);
xDot=1/B*f(1);

function f=pkForce(xV,b)
b1=1;
mu=1;
nu=0.3;
x=xV(1);
y=xV(2);
D=mu*b1/(2*pi*(1-nu));
R2=(x.^2+y.^2+b1^2).^2;
sxx=-D*y.*(3*x.^2+y.^2)./R2;
syy=D*y.*(x.^2-y.^2)./R2;
sxy=D*x.*(x.^2-y.^2)./R2;
S=[sxx sxy 0;
   sxy syy 0;
   0    0  0];
%b1=[b 0 0]';
%xi=[0 0 1]';
f=cross(S*b,[0 0 1]');

sxx*b(1) +sxy*B(2)