\documentclass[10pt]{report}
\usepackage{graphicx}
%\usepackage[ruled,vlined]{algorithm2e}
\usepackage[]{algorithm2e}
\usepackage{subcaption}
%\usepackage{subfig}


\graphicspath{{../Figures/}}		% path to graphic files
\usepackage{fullpage}
%\usepackage{fancyhdr}
%\rhead{
%\includegraphics[width=\textwidth]{header}
%}
%\lhead{
%\includegraphics[width=\textwidth]{header}
%}
  \usepackage[dvipsnames]{xcolor}
  \usepackage{tikz}
\usepackage{verbatim}

\usepackage{bbding} 

\usepackage[most]{tcolorbox}
\newtcblisting{commandshell}{colback=black,colupper=white,
listing only,listing options={style=tcblatex,language=sh},
every listing line={\textcolor{green}{\small\ttfamily\bfseries  \$ }}}


\usepackage{bm}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm} 
%\usepackage{wrapfig} 
%\usepackage[percent]{overpic}

\usepackage{natbib} 
\usepackage{lipsum}


\usepackage[pagebackref]{hyperref}
\hypersetup{
   % pagebackref =true,
    colorlinks,%
    citecolor=blue,% 
    filecolor=black,%
    linkcolor=magenta,% 
    urlcolor=black
}

  
%\author{Giacomo Po}
%\title{Field Equations of Discrete Dislocations}





\begin{document}


\thispagestyle{empty}
\begin{tikzpicture}[remember picture,overlay] 
\def \Px{-3.5}
\def \Py{-20}
\def \Lx{1.2*\textwidth}
\def \Ly{10}
\node[opacity=1,inner sep=0pt] at (current page.center){\includegraphics[width=\paperwidth,height=\paperheight]{straight_lines}};
 \fill [black, opacity=0.7]
       (\Px,\Py) -- (\Px,\Py+\Ly) -- (\Px+\Lx,\Py+\Ly)-- (\Px+\Lx,\Py) -- cycle;
\node[anchor=north west] at (\Px+3.0,\Py+\Ly-1) {\Huge{\textcolor{white}{
\textbf{MoDELib manual}}}};
\node[anchor=north west] at (\Px+3.0,\Py+\Ly-2) {\Large{\textcolor{white}{
???}}};
%\node[anchor=north west] at (\Px+3.0,\Py+\Ly-2.8) {\Large{\textcolor{white}{
%}}};

\draw[very thick,orange]  (\Px,\Py+0.4*\Ly) --  (\Px+\Lx,\Py+0.4*\Ly);

\node[anchor=north west] at (\Px+3.0,\Py+\Ly-4) {\Huge{\textcolor{white}{
 ???}}};
\draw[very thick,orange]  (\Px,\Py+0.4*\Ly) --  (\Px+\Lx,\Py+0.4*\Ly);


\node[anchor=north west] at (\Px+3.0,\Py+\Ly-7) {\Huge{\textcolor{white}{
Giacomo Po}}};
\node[anchor=north west] at (\Px+3.0,\Py+\Ly-8) {\Large{\textcolor{white}{
\today}}};
%\node[anchor=north west] at (\Px+4.5,\Py+\Ly-7) {\large{\textcolor{white}{
%10755 Massachusetts Ave}}};
%\node[anchor=north west] at (\Px+4.5,\Py+\Ly-8) {\large{\textcolor{white}{
%Los Angeles, CA}}};
 \end{tikzpicture}

%\maketitle

\tableofcontents



\newtheorem{mytheorem}{Theorem}
\newtheorem{mydefinition}{Definition}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\newtheorem{Norm}{Definition. Norm}
%\begin{mydefinition}
%fdsfsd
%\end{mydefinition}

%\newtheorem{SemiNorm}{Definition. Semi Norm}

%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%
%\section*{Abstract}

%SEE MURA BOOK PAGE 



\newcommand{\dL}[0]{\, \text{d}L}
\newcommand{\dA}[0]{\, \text{d}A}
\newcommand{\dV}[0]{\, \text{d}V}

\newcommand{\GP}[0]{G^\Delta}
\newcommand{\hGP}[0]{\hat{G}^\Delta}

\newcommand{\GH}[0]{G^L}
\newcommand{\hGH}[0]{\hat{G}^L}

\newcommand{\bPc}[0]{\beta^{P}}
%\newcommand{\bPg}[0]{\beta^{P}}

%\newcommand{\bEg}[0]{\beta}
\newcommand{\bEc}[0]{\beta}

\newcommand{\eEc}[0]{\varepsilon}





\input{tex/elasticTheory}





%%%%%%%%%%%%%%%%%%%%%%
\section{The elastic field of a plastic eigenstrain}

%%%%%%%%%%%%%%%%%%%%%%
\subsection{Displacement field due to eigenstrain}
\begin{align}
\begin{cases}
u_{k,l}=\beta^e_{kl}+\beta^p_{kl}&\mbox{linearized kinematics}\\
\sigma_{ij}=c_{ijkl}\beta^e_{kl}&\mbox{constitutive equation}\\
\sigma_{ij,j}=0&\mbox{equilibrium}
\end{cases}
\label{problem}
\end{align}
With trivial substitutions, problem (\ref{problem}) can be cast into the following pde for the displacement field $u_k$:
\begin{align}
c_{ijkl}u_{k,lj}-c_{ijkl}\beta^p_{kl,j}=0
\label{mainPDE}
\end{align}
If we let 
\begin{align}
f_i=-c_{ijkl}\beta^p_{kl,j}
\end{align}
then Eq.~(\ref{mainPDE}) becomes identical to the well known problem of distributed  force $f_i$ in an elastic medium:
\begin{align}
c_{ijkl}u_{k,lj}+f_i=0
\label{pointForcePDE}
\end{align}
Now assume that the solution $G_{km}$ to the corresponding Green's problem 
\begin{align}
c_{ijkl}G_{km,lj}(\bm x,\bm x')+\delta_{im}\delta(\bm x-\bm x')=0
\label{greenFunctionElasticity}
\end{align}
is known. Then Multiply by $f_m(\bm x')$ and integrate over the volume:
\begin{align}
0&=\int \left[c_{ijkl}G_{km,lj}(\bm x,\bm x')f_m(\bm x')+\delta(\bm x-\bm x')f_i(\bm x')\right]dV'\nonumber\\
&=c_{ijkl}\left[\int G_{km}(\bm x,\bm x')f_m(\bm x')dV'\right]_{,lj}+f_i(\bm x)
\end{align}
 Therefore Eq.~(\ref{pointForcePDE}) admits the solution:
\begin{align}
u_{k}(\bm x)=\int G_{km}(\bm x,\bm x')f_m(\bm x')dV'=c_{mpqr}\beta^p_{qr,p'}
\end{align}

\begin{align}
u_{i}= G_{im} * f_m=-c_{mnpq}G_{im} * \beta^p_{pq,n}
\end{align}


%where $G_{ij}$ is the Green's function of the differential  operator of linear elasticity $c_{ijkl}\partial_j\partial_l$ and, by definition ,satisfies:
%\begin{align}
%c_{ijkl}G_{km,lj}(\bm x,\bm x')+\delta_{im}\delta(\bm x-\bm x')=0
%\end{align}

\subsection{Distortion}
Displacement gradient
\begin{align}
u_{k,l}(\bm x)&=\int G_{km,l}(\bm x,\bm x')f_m(\bm x')dV'=-\int G_{km,l}(\bm x,\bm x')c_{mpqr}\beta^p_{qr,p'}dV'\nonumber\\
&=-\oint G_{km,l}(\bm x,\bm x')c_{mpqr}\beta^p_{qr}\hat{n}_{p'}dA'+\int G_{km,lp'}(\bm x,\bm x')c_{mpqr}\beta^p_{qr}dV'\nonumber\\
&=-\int G_{km,lp}(\bm x,\bm x')c_{mpqr}\beta^p_{qr}dV'\nonumber\\
&=-\int c_{qrmp}G_{mk,lp}(\bm x,\bm x')\beta^p_{qr}dV'\nonumber\\
\end{align}


\subsection{Elastic strain}

$\alpha_{ij}=-\epsilon_{jkm}\beta^p_{ik,m}$
so
$$-\epsilon_{jpq}\alpha_{ij}=\epsilon_{jpq}\epsilon_{jkm}\beta^p_{ik,m}=(\delta_{pk}\delta_{qm}-\delta_{pm}\delta_{qk})\beta^p_{ik,m}=\beta^p_{ip,q}-\beta^p_{iq,p}$$


Consider~({\ref{greenFunctionElasticity}) 
\begin{align}
c_{ijpq}G_{pk,qj}(\bm x,\bm x')+\delta_{ik}\delta(\bm x-\bm x')=0
\end{align}
and multiply by $\beta^p_{il}(\bm x')$ and integrate over volume
\begin{align}
\int c_{ijpq}G_{pk,qj}(\bm x,\bm x')\beta^p_{il}(\bm x')dV'=-\int \delta_{ik}\delta(\bm x-\bm x')\beta^p_{il}(\bm x')dV'=-\beta^p_{kl}(\bm x)
\end{align}


\begin{align}
\beta^e_{kl}&=u_{k,l}-\beta^p_{kl}\nonumber\\
&=-\int c_{qrmp}G_{mk,lp}(\bm x,\bm x')\beta^p_{qr}(\bm x')dV'+\int c_{ijpq}G_{pk,qj}(\bm x,\bm x')\beta^p_{il}(\bm x')dV'\nonumber\\
&=-\int c_{irmj}G_{mk,j'l'}(\bm x,\bm x')\beta^p_{ir}(\bm x')dV'+\int c_{irmq}G_{mk,q'r'}(\bm x,\bm x')\beta^p_{il}(\bm x')dV'\nonumber\\
&=\int c_{irmj}G_{mk,j'}(\bm x,\bm x')\beta^p_{ir,l'}(\bm x')dV'-\int c_{irmj}G_{mk,j'}(\bm x,\bm x')\beta^p_{il,r'}(\bm x')dV'\nonumber\\
&=-\int c_{irmj}G_{mk,j'}(\bm x,\bm x')\epsilon_{srl}\alpha_{is}(\bm x')dV'\nonumber\\
&=\int c_{irmj}G_{mk,j}(\bm x,\bm x')\epsilon_{srl}\alpha_{is}(\bm x')dV'
\end{align}
So the elastic strain depends only on the incompatibility of $\beta^p$!!

%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Discrete Dislocations}

The plastic distortion of a discrete dislocation loop is \citet[p. 46/47]{Mura:1987wt} :
\begin{align}
\beta^P_{ij}(\bm x):=-\int_\mathcal{S} \delta(\bm x-\bm x')b_idS_j'
\end{align}
Note that here $\hat{\bm n}$ is the surface normal, which consistently with the right-hand rule, determines the line direction of the bounding dislocation line $\mathcal{C}$. This definition is consistent with the FS/RH convention of the Burgers vector. 

Now we \textit{define} the discrete dislocation density tensor as:


\begin{align}
\alpha_{ij}&:=\oint\delta(\bm x-\bm x')b_idl_j'
%-\epsilon_{jkm}\beta^p_{ik,m}=-\epsilon_{jkm}\partial_m\left(-\int\delta(\bm x-\bm x')b_ids_k'\right)\nonumber\\
%&=b_i\int\epsilon_{jkm}\partial_{m'}\left(\delta(\bm x-\bm x')\right)ds_k'\nonumber\\
%&=b_i\oint\delta(\bm x-\bm x')dl_j'
\end{align}

Then we can verify the identities:
\begin{align}
\alpha_{ij}=-\epsilon_{jkm}\beta^P_{im,k}
\end{align}
\begin{align}
\beta^P_{ip,q}=\beta^P_{iq,p}+\epsilon_{jpq}\alpha_{ij}
\end{align}

This follows directly from the Kelvin-Stokes theorem~(\ref{KelvinStokesCorollary}) that:
\begin{align}
-\epsilon_{jkm}\beta^P_{im,k}&=-\epsilon_{jkm}\partial_k\left(-\int_\mathcal{S} \delta(\bm x-\bm x')b_ids_m'\right)=-b_i\int_\mathcal{S} \epsilon_{jkm}\partial_{k'}\delta(\bm x-\bm x')ds_m'\nonumber\\
&=b_i\int_\mathcal{S} \epsilon_{jmk}\partial_{k'}\delta(\bm x-\bm x')ds_m'=b_i\oint\delta(\bm x-\bm x')dl_j'=\oint\delta(\bm x-\bm x')b_idl_j'
\end{align}


Note that if $b_i(\bm x')$ is not constant (Somigliana dislocations), then the result cannot be expressed as a line integral.
\footnote{
For a Somigliana dislocation:
\begin{align}
\alpha_{ij}&=-\epsilon_{jkm}\beta^p_{ik,m}=-\epsilon_{jkm}\partial_m\left(-\int\delta(\bm x-\bm x')b_i(\bm x')ds_k'\right)=\epsilon_{jkm}\left(\int\partial_m(\delta(\bm x-\bm x'))b_i(\bm x')ds_k'\right)
\nonumber\\
&=-\epsilon_{jkm}\left(\int\partial_{m'}(\delta(\bm x-\bm x'))b_i(\bm x')ds_k'\right)=-\epsilon_{jkm}\left(\int\partial_{m'}(\delta(\bm x-\bm x')b_i(\bm x'))ds_k'-\int\delta(\bm x-\bm x')b_{i,m'}(\bm x')ds_k'\right)\nonumber\\
%&=b_i\int\epsilon_{jkm}\partial_{m'}\left(\delta(\bm x-\bm x')\right)ds_k'\nonumber\\
&=-\oint\delta(\bm x-\bm x')b_i(\bm x')dl_j'+\epsilon_{jkm}\int\delta(\bm x-\bm x')b_{i,m'}(\bm x')ds_k'
\end{align}
%HERE THERE SHOULD BE A NEGATIVE SIGN DUE TO $\partial_m=-\partial_{m'}$!!!!!
}


%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Displacement field}


\begin{align}
u_{i}= -c_{mnpq}G_{im} * \beta^p_{pq,n}= -c_{mnpq}G_{im,n} * \beta^p_{pq}
\end{align}
Therefore, for a dislocation loop:
\begin{align}
u_{i}(\bm x)= \int_\mathcal{S} c_{mnpq}G_{im,n}(\bm x-\bm x') b_p dS_q'
\end{align}
same as eq. (5.3) in \citet{deWit:1960vb}. 


%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Elastic distortion}

%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Elastic stress}

\begin{align}
R_{,pp}=\frac{2}{R}\\
R_{,ppk}=-2\frac{R_k}{R^3}
\end{align}





\begin{align}
F^p_{\alpha J}(\bm X)=\delta_{\alpha J}-b_\alpha\int_\mathcal{S}\delta(\bm X-\bm X')\hat{N}_JdA
\end{align}




%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Closed-form solution for isotropic materials}
In the isotropic case:
\begin{align}
c_{mnpq}=\mu\left(\frac{2\nu}{1-2\nu}\delta_{mn}\delta_{pq}+\delta_{mp}\delta_{nq}+\delta_{mq}\delta_{np}\right)
\end{align}
and
\begin{align}
G_{im,n}=\frac{1}{16\pi \mu(1-\nu)}\left[2(1-\nu)\delta_{im}\partial_n\Delta-\partial_n\partial_i\partial_m\right]R
\end{align}
Therefore
\begin{align}
c_{mnpq}G_{im,n}=\frac{1}{8\pi(1-\nu)}\left[\nu\delta_{pq}\partial_i\Delta+(1-\nu)\left(\delta_{ip}\partial_q\Delta+\delta_{iq}\partial_p\Delta\right)-\partial_i\partial_p\partial_q\right]R
\end{align}
so
\begin{align}
u_i&=-\frac{1}{8\pi(1-\nu)}\left[\nu\delta_{pq}\partial_i\Delta+(1-\nu)\left(\delta_{ip}\partial_q\Delta+\delta_{iq}\partial_p\Delta\right)-\partial_i\partial_p\partial_q\right]R * \beta^P_{pq}\nonumber\\
&=-\frac{1}{8\pi}\partial_q\Delta R* \beta^P_{iq}-\frac{1}{8\pi(1-\nu)}\left[\nu\delta_{pq}\partial_i\Delta+(1-\nu)\delta_{iq}\partial_p\Delta-\partial_i\partial_p\partial_q\right]R * \beta^P_{pq}\nonumber\\
\end{align}
Notice that
\begin{align}
-\frac{1}{8\pi}\partial_q\Delta R* \beta^P_{iq}=\frac{b_i}{8\pi}\int_\mathcal{S} \partial_q\Delta R dS_q'=-\frac{b_i}{4\pi}\int_\mathcal{S} -\frac{1}{2}\partial_q\Delta R dS_q'=-\frac{b_i}{4\pi}\underbrace{\int_\mathcal{S} \frac{R_q}{R^3} dS_q'}_{\Omega}=-\frac{b_i\Omega}{4\pi}
\end{align}
so
\begin{align}
u_i&=-\frac{b_i\Omega}{4\pi}-\frac{1}{8\pi(1-\nu)}\left[\nu\delta_{pq}\partial_i\Delta+(1-\nu)\delta_{iq}\partial_p\Delta-\partial_i\partial_p\partial_q\right]R * \beta^P_{pq}\nonumber\\
&=-\frac{b_i\Omega}{4\pi}-\frac{1}{8\pi(1-\nu)}\left[\nu\partial_i\Delta R * \beta^P_{pp}+(1-\nu)\partial_p\Delta R * \beta^P_{pi}-\partial_i\partial_p\partial_q R * \beta^P_{pq}\right]
\end{align}
Now use: 
\begin{align}
\partial_i\partial_p\partial_q R * \beta^P_{pq} = \partial_i\partial_q R * \beta^P_{pq,p} = \partial_i\partial_q R * \left(\beta^P_{pp,q}+\epsilon_{kqp}\alpha_{pk}\right)=  \partial_i\Delta R * \beta^P_{pp}+ \partial_i\partial_q R * \epsilon_{kqp}\alpha_{pk}\\
\end{align}
and obtain
\begin{align}
u_i&=-\frac{b_i\Omega}{4\pi}-\frac{1}{8\pi(1-\nu)}\left[(1-\nu)\partial_p\Delta R * \beta^P_{pi} -(1-\nu)\partial_i\Delta R * \beta^P_{pp}- \partial_i\partial_q R * \epsilon_{kqp}\alpha_{pk}\right]
\end{align}
Now use: 
\begin{align}
\partial_p\Delta R * \beta^P_{pi} = \Delta R * \beta^P_{pi,p} = \Delta R * \left(\beta^P_{pp,i}+\epsilon_{kip}\alpha_{pk}\right) =  \partial_i\Delta R * \beta^P_{pp}+ \Delta R * \epsilon_{kip}\alpha_{pk}
\end{align}
and obtain
\begin{align}
u_i&=-\frac{b_i\Omega}{4\pi}-\frac{1}{8\pi(1-\nu)}\left[(1-\nu)  \Delta R * \epsilon_{kip}\alpha_{pk} - \partial_i\partial_q R * \epsilon_{kqp}\alpha_{pk}\right]\nonumber\\
&=-\frac{b_i\Omega}{4\pi}-\frac{1}{8\pi}\epsilon_{kqp}\left[ \delta_{iq}\Delta  -\frac{1}{1-\nu} \partial_i\partial_q  \right] R * \alpha_{pk}\nonumber\\
&=-\frac{b_i\Omega}{4\pi}-\frac{1}{8\pi}\epsilon_{lmk}\left[ \delta_{im}\Delta  -\frac{1}{1-\nu} \partial_i\partial_m  \right] R * \alpha_{kl}\nonumber\\
&=-\frac{b_i\Omega}{4\pi}-U_{ikl} R * \alpha_{kl}
\end{align}
The operator $U_{ill}$ is:
\begin{align}
U_{ikl}=\frac{1}{8\pi}\epsilon_{klm}\left[ \delta_{im}\Delta  -\frac{1}{1-\nu} \partial_i\partial_m  \right]
\end{align}




%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{Displacement field of a dislocation loop}
complete steps here
\begin{align}
\bm u=-\frac{\bm b\Omega}{4\pi}-\frac{1}{4\pi}\oint\left[\frac{\bm b\times\bm \xi}{R}+\frac{\lambda+\mu}{\lambda+2\mu}\left(\frac{\bm \xi\times\bm b}{R}-\frac{(\bm b\times\bm R)\cdot\bm \xi}{R^3}\bm R\right)\right]dl
\label{displcementIsotropicSolid}
\end{align}
where 
\begin{align}
\Omega=\int\frac{R_k\hat{n}_k}{R^3}dS=-\frac{1}{2}\int R_{,ppk}\hat{n}_kdS
\end{align}
When using the line integral expression of the solid angle (\ref{solidAngle2Line2}), eq.~(\ref{displcementIsotropicSolid}) becomes:
\begin{align}
\bm u&=\frac{1}{4\pi}\oint\left[\frac{(\bm s\times\bm R)\cdot\bm\xi}{R(R+\bm s\cdot\bm R)}\bm b+\frac{\bm \xi\times\bm b}{R}+\frac{1}{2(1-\nu)}\left(\frac{\bm b\times \bm \xi}{R}+\frac{(\bm b\times\bm R)\cdot\bm \xi}{R^3}\bm R\right)\right]dl\nonumber\\
&=\underbrace{\frac{1}{8\pi(1-\nu)}}_{c_4}\oint\frac{1}{R}\left[2\underbrace{(1-\nu)}_{c1}\frac{(\bm s\times\bm R)\cdot\bm\xi}{R+\bm s\cdot\bm R}\bm b+\underbrace{(1-2\nu)}_{c_3}\bm \xi\times\bm b+\frac{(\bm \xi\times\bm b)\cdot\bm R}{R^2}\bm R\right]dl
\label{displcementIsotropicLine}
\end{align}
%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{Displacement gradient}

\begin{align}
u_{i,j}&=-\frac{b_i\Omega_{,j}}{4\pi}-\partial_jU_{ikl} R * \alpha_{kl}
=-\frac{1}{8\pi}\partial_j\partial_q\Delta R* \beta^P_{iq}-\partial_jU_{ikl} R * \alpha_{kl}
=-\frac{1}{8\pi}\partial_q\Delta R* \beta^P_{iq,j}-\partial_jU_{ikl} R * \alpha_{kl}\nonumber\\
&=-\frac{1}{8\pi}\partial_q\Delta R*\left( \beta^P_{ij,q}+\epsilon_{kqj}\alpha_{ik}\right)-\partial_jU_{ikl} R * \alpha_{kl}\nonumber\\
&=\underbrace{-\frac{1}{8\pi}\Delta\Delta R}_{\delta(R)}* \beta^P_{ij}-\frac{1}{8\pi}\partial_q\Delta R*\epsilon_{kqj}\alpha_{ik}-\partial_jU_{ikl} R * \alpha_{kl}\nonumber\\
&=\beta^P_{ij}-\frac{1}{8\pi}\partial_q\Delta R*\epsilon_{kqj}\alpha_{ik}-\partial_jU_{ikl} R * \alpha_{kl}\nonumber\\
&=\beta^P_{ij}+B_{ijkl}R*\alpha_{kl}
\end{align}

\begin{align}
B_{ijkl}&=-\partial_{j}U_{ikl}-\frac{1}{8\pi}\delta_{ik}\epsilon_{lmj}\partial_m\Delta
=-\frac{1}{8\pi}\epsilon_{klm}\left[ \delta_{im}\partial_j\Delta  -\frac{1}{1-\nu} \partial_j\partial_i\partial_m  \right]-\frac{1}{8\pi}\delta_{ik}\epsilon_{lmj}\partial_m\Delta\nonumber\\
&=\frac{1}{8\pi}\left[\left(-\delta_{ik}\epsilon_{jlm}\partial_m+\epsilon_{ilk}\partial_j\right)\Delta+\frac{1}{1-\nu}\epsilon_{klm}\partial_i\partial_j\partial_m\right]
\end{align}
same as de Wit p 264.
%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{Elastic distortion}
\begin{align}
\beta^E_{ij}=u_{i,j}-\beta^P_{ij}=B_{ijkl}R*\alpha_{kl}
\end{align}

%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{Elastic strain}
\begin{align}
\varepsilon^E_{ij}=\frac{1}{2}\left(\beta^E_{ij}+\beta^E_{ji}\right)=E_{ijkl}R*\alpha_{kl}
\end{align}

\begin{align}
E_{ijkl}&=\frac{1}{2}\left(B_{ijkl}+B_{jikl}\right)\nonumber\\
&=\frac{1}{16\pi}\left[\left(-\delta_{ik}\epsilon_{jlm}\partial_m-\delta_{jk}\epsilon_{ilm}\partial_m+\epsilon_{ilk}\partial_j+\epsilon_{jlk}\partial_i\right)\Delta+\frac{2}{1-\nu}\epsilon_{klm}\partial_i\partial_j\partial_m\right]\nonumber\\
&=\frac{1}{16\pi}\left[\left(-\delta_{ik}\epsilon_{jlm}\delta_{mr}-\delta_{jk}\epsilon_{ilm}\delta_{mr}+\epsilon_{ilk}\delta_{jr}+\epsilon_{jlk}\delta_{ir}\right)\partial_r\Delta+\frac{2}{1-\nu}\epsilon_{klm}\partial_i\partial_j\partial_m\right]\nonumber\\
&=\frac{1}{16\pi}\left[\left(\epsilon_{ilk}\delta_{jr}-\delta_{jk}\epsilon_{ilm}\delta_{mr}+\epsilon_{jlk}\delta_{ir}-\delta_{ik}\epsilon_{jlm}\delta_{mr}\right)\partial_r\Delta+\frac{2}{1-\nu}\epsilon_{klm}\partial_i\partial_j\partial_m\right]\nonumber\\
&=\frac{1}{16\pi}\left[\left(\epsilon_{ilm}(\delta_{mk}\delta_{jr}-\delta_{jk}\delta_{mr})+\epsilon_{jlm}(\delta_{mk}\delta_{ir}-\delta_{ik}\delta_{mr})\right)\partial_r\Delta+\frac{2}{1-\nu}\epsilon_{klm}\partial_i\partial_j\partial_m\right]\nonumber\\
&=\frac{1}{16\pi}\left[\left(\epsilon_{ilm}\epsilon_{smj}\epsilon_{skr}+\epsilon_{jlm}\epsilon_{smi}\epsilon_{skr}\right)\partial_r\Delta+\frac{2}{1-\nu}\epsilon_{klm}\partial_i\partial_j\partial_m\right]\nonumber\\
&=\frac{1}{16\pi}\left[\epsilon_{skr}\left(\epsilon_{mil}\epsilon_{mjs}+\epsilon_{mjl}\epsilon_{mis}\right)\partial_r\Delta+\frac{2}{1-\nu}\epsilon_{klm}\partial_i\partial_j\partial_m\right]\nonumber\\
&=\frac{1}{16\pi}\left[\epsilon_{skr}\left(\delta_{ij}\delta_{ls}-\delta_{is}\delta_{lj}+\delta_{ij}\delta_{ls}-\delta_{js}\delta_{il}\right)\partial_r\Delta+\frac{2}{1-\nu}\epsilon_{klm}\partial_i\partial_j\partial_m\right]\nonumber\\
&=\frac{1}{16\pi}\left[\left(2\epsilon_{lkm}\delta_{ij}-\epsilon_{ikm}\delta_{lj}-\epsilon_{jkm}\delta_{il}\right)\partial_m\Delta+\frac{2}{1-\nu}\epsilon_{klm}\partial_i\partial_j\partial_m\right]\nonumber\\
\end{align}

same as de Wit p 264.

%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{Stress}
\begin{align}
\sigma_{pq}=c_{pqij}\beta^E_{ij}=
\mu\left(\frac{2\nu}{1-2\nu}\delta_{pq}\delta_{ij}+\delta_{pi}\delta_{qj}+\delta_{pj}\delta_{qi}\right)E_{ijkl}R*\alpha_{kl}=S_{pqkl}*\alpha_{kl}
\end{align}

\begin{align}
S_{ijkl}=\frac{\mu}{8\pi}\left[\left(\delta_{il}\epsilon_{jmk}+\delta_{jl}\epsilon_{imk}\right)\partial_m\Delta+\frac{2}{1-\nu}\epsilon_{klm}\left(\partial_{i}\partial_j\partial_m-\delta_{ij}\partial_m\Delta\right)\right]
\end{align}



%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{Stress field}
\begin{equation}
\sigma_{ij}(\bm F)=\frac{\mu b_n}{8\pi}\int_\mathcal{S} \left[R_{,mpp}\left(\in_{jmn}\xi_i+\in_{imn}\xi_j\right)+\frac{2}{1-\nu}\in_{kmn}\left(R_{,ijm}-\delta_{ij}R_{,ppm}\right)\xi_k\right]dl^s
\end{equation}
where $\bm R=\bm F-\bm S$ is the vector connecting the source point to the field point and $\xi=\frac{d\bm S}{dl^s}$ s the unit tangent along the source dislocation. 

Substituting 
\begin{equation}
R_{,ijk}=-\frac{\delta_{ij}R_k+\delta_{jk}R_i+\delta_{ki}R_j}{R^3}+\frac{3R_iR_jR_k}{R^5} \ \ \ \ \ \ \    R_{,ipp}=-\frac{2R_i}{R^3}
\end{equation}

\begin{equation}
\sigma_{ij}(\bm F)=\frac{\mu b_n}{4\pi}\int_\mathcal{S} \left[-\frac{R_m}{R^3}\left(\in_{jmn}\xi_i+\in_{imn}\xi_j\right)+\frac{1}{1-\nu}\in_{kmn}\left(\frac{\delta_{ij}R_m-\delta_{jm}R_i-\delta_{mi}R_j}{R^3}+\frac{3R_iR_jR_m}{R^5}\right)\xi_k\right]dl^s
\end{equation}




or in dyadic form:

\begin{eqnarray}
\frac{d\bm \sigma}{dl}&=&\frac{\mu}{4\pi R^2}\left\{\hat{\bm\xi}\otimes(\bm b\times \hat{\bm R})+(\bm b\times \hat{\bm R})\otimes\hat{\bm\xi}\right.\nonumber\\
&+&\left.\frac{1}{1-\nu}\left[\hat{\bm R}\otimes(\hat{\bm\xi}\times\bm b)+(\hat{\bm\xi}\times\bm b)\otimes\hat{\bm R}
+ \left[(\hat{\bm R}\times\bm b)\cdot\hat{\bm\xi}\right]\left(\bm I + 3\hat{\bm R}\otimes\hat{\bm R} \right)\right]\right\}
%\frac{R_m}{R^3}\left(\in_{jmn}\xi_i+\in_{imn}\xi_j\right)+\frac{1}{1-\nu}\in_{kmn}\left(\frac{\delta_{ij}R_m-\delta_{jm}R_i-\delta_{mi}R_j}{R^3}+\frac{3R_iR_jR_m}{R^5}\right)\xi_k
\end{eqnarray}

more efficient to compute
\begin{eqnarray}
\frac{d\bm \sigma}{dl}&=&\frac{\mu}{4\pi (1-\nu)R^2}\left\{(1-\nu)\left[\hat{\bm\xi}\otimes(\bm b\times \hat{\bm R})+(\bm b\times \hat{\bm R})\otimes\hat{\bm\xi}\right]\right.\nonumber\\
&+&\left.\hat{\bm R}\otimes(\hat{\bm\xi}\times\bm b)+(\hat{\bm\xi}\times\bm b)\otimes\hat{\bm R}\right.\nonumber\\
&+&\left. \left[(\hat{\bm R}\times\bm b)\cdot\hat{\bm\xi}\right]\left(\bm I + 3\hat{\bm R}\otimes\hat{\bm R} \right)\right\}
%\frac{R_m}{R^3}\left(\in_{jmn}\xi_i+\in_{imn}\xi_j\right)+\frac{1}{1-\nu}\in_{kmn}\left(\frac{\delta_{ij}R_m-\delta_{jm}R_i-\delta_{mi}R_j}{R^3}+\frac{3R_iR_jR_m}{R^5}\right)\xi_k
\end{eqnarray}



or factoring the symmetric part

\begin{eqnarray}
\frac{d\bm \sigma}{dl}&=&\frac{\mu}{2\pi (1-\nu)R^2}\left\{(1-\nu)\hat{\bm\xi}\otimes(\bm b\times \hat{\bm R})
+\hat{\bm R}\otimes(\hat{\bm\xi}\times\bm b)
+\frac{1}{2}\left[(\hat{\bm R}\times\bm b)\cdot\hat{\bm\xi}\right]\left(\bm I + 3\hat{\bm R}\otimes\hat{\bm R} \right)\right\}_{sym}
%\frac{R_m}{R^3}\left(\in_{jmn}\xi_i+\in_{imn}\xi_j\right)+\frac{1}{1-\nu}\in_{kmn}\left(\frac{\delta_{ij}R_m-\delta_{jm}R_i-\delta_{mi}R_j}{R^3}+\frac{3R_iR_jR_m}{R^5}\right)\xi_k
\end{eqnarray}

where $\bm x_{\text{sym}}=\frac{1}{2}(\bm x+\bm x^T)$

\subsection{Cai 2006}
%\subsubsection{Stress field}
\begin{equation}
\sigma^\text{ns}_{ij}(\bm F)=\frac{\mu b_n}{8\pi}\int_\mathcal{S} \left[R_{a,mpp}\left(\in_{jmn}\xi_i+\in_{imn}\xi_j\right)+\frac{2}{1-\nu}\in_{kmn}\left(R_{a,ijm}-\delta_{ij}R_{a,ppm}\right)\xi_k\right]dl^s
\end{equation}
where $\bm R=\bm F-\bm S$ is the vector connecting the source point to the field point and $\xi=\frac{d\bm S}{dl^s}$ s the unit tangent along the source dislocation. 

Substituting 
\begin{equation}
R_{,ijk}=-\frac{\delta_{ij}R_k+\delta_{jk}R_i+\delta_{ki}R_j}{R_a^3}+\frac{3R_iR_jR_k}{R_a^5} \ \ \ \ \ \ \    R_{a,ipp}=-\left(2+\frac{3a^2}{R_a^2}\right)\frac{R_i}{R_a^3}
\end{equation}
we find
\begin{equation}
\sigma_{ij}(\bm F)=\frac{\mu b_n}{4\pi}\int_\mathcal{S} \left[-\left(1+\frac{3a^2}{2R_a^2}\right)\frac{R_m}{R_a^3}\left(\in_{jmn}\xi_i+\in_{imn}\xi_j\right)+\frac{1}{1-\nu}\in_{kmn}\left(\frac{\delta_{ij}\left(1+\frac{3a^2}{R_a^2}\right)R_m-\delta_{jm}R_i-\delta_{mi}R_j}{R_a^3}+\frac{3R_iR_jR_m}{R_a^5}\right)\xi_k\right]dl^s
\end{equation}
In dyadic form
\begin{align}
\frac{d\bm \sigma}{d L}=\frac{\mu }{4\pi (1-\nu)R_a^2}&\left\{(1-\nu)\left(1+\frac{3a^2}{2R_a^2}\right)\left(\hat{\bm\xi}\otimes (\bm b\times \tilde{\bm R})+ (\bm b\times \tilde{\bm R})\otimes\hat{\bm\xi}\right)\right.\nonumber\\
&\left.+\left(\tilde{\bm R}\otimes(\hat{\bm\xi}\times\bm b)+(\hat{\bm\xi}\times\bm b)\otimes \tilde{\bm R}\right)\right\}\nonumber\\
%
&\left.+[(\tilde{\bm R}\times\bm b)\cdot\hat{\bm \xi}]\left[\left(1+\frac{3a^2}{R_a^2}\right)\bm I+3\tilde{\bm R}\otimes \tilde {\bm R}\right]\right\}
\end{align}
where $\tilde{\bm R}=\bm R/R_a$

\subsection{From Po Lazar 2014}

\begin{align}
 \bm u^0(\bm x)=-\frac{\bm b\Omega^0}{4\pi}-\frac{1}{8\pi(1-\nu)}\oint_\mathcal{L}&\frac{1}{R}\left\{\ 
 \left(1-2\nu\right) \bm b\times\hat{\bm \xi}'
+ \left[\hat{\bm R}\cdot\left(\bm b\times\hat{\bm \xi}' \right) \right]\hat{\bm R}  \right\}\dL'
\end{align}


\begin{align}
\bm\sigma^0(\bm x)=\frac{\mu}{4\pi(1-\nu)}\oint_{\mathcal{L}}&\frac{1}{R^2}\left\{
(1-\nu)\left[\hat{\bm\xi}'\otimes(\bm b\times\hat{\bm R})+(\bm b\times\hat{\bm R})\otimes\hat{\bm\xi}'\right] 
+\left[(\hat{\bm \xi}'\times\bm b)\otimes\hat{\bm R}+\hat{\bm R}\otimes(\hat{\bm \xi}'\times\bm b)\right] \right. \nonumber\\
&\left.+\hat{\bm R}\cdot(\bm b\times\hat{\bm\xi}')\left[3\hat{\bm R}\otimes\hat{\bm R}+\bm I \right]
\right\}\dL'
\end{align}


\subsubsection{Numerical implementation}

\begin{align}
 \mathbf{u}(\bm x)=-\frac{\mathbf{ b}\Omega(\mathbf x)}{4\pi}-\frac{1}{8\pi(1-\nu)}\oint_\mathcal{L}&\frac{1}{R}\left\{\ 
 \left(1-2\nu\right) \mathbf{ b}\times\hat{\mathbf{ \xi}}'
+ \left[\hat{\mathbf{ R}}\cdot\left(\mathbf{ b}\times\hat{\mathbf{ \xi}}' \right) \right]\hat{\mathbf{ R}}  \right\}\dL'
\end{align}
where $\mathbf{R}=\mathbf x-\mathbf x'$, and  $\Omega(\mathbf x)$ is the solid angle subtended by the surface $\mathcal{S}$:
\begin{align}
\Omega(\mathbf{x})=\int_\mathcal{S}\left(-\frac{1}{2}\partial_k\Delta R\right)\ dA'_k=\int_\mathcal{S} v_k(\mathbf R)\ dA'_k&&v_k(\mathbf y)=\frac{y_k}{y^3}
\end{align}
In order to transform the solid angle into a line integral, we need to introduce a fictitious vector field $v_k^f(\mathbf R)$ with the property $v^f_{k,k}=-v_{k,k}$. In this way we can find a vector potential $\Psi_m(\mathbf{R})$ for the divergence-less sum $v_k+v^f_k$. The vector potential satisfies both $v_k+v^f_k=\epsilon_{klm}\Psi_{m,l}$, and $\Psi_{k,k}=0$. Therefore, using Stokes theorem, we can write
\begin{align}
\Omega(\mathbf{x})&=\int_\mathcal{S} \left(\epsilon_{klm}\Psi_{m,l}-v^f_k\right)\ dA'_k=\int_\mathcal{S} \left(-\epsilon_{klm}\Psi_{m,l'}-v^f_k\right)\ dA'_k\nonumber\\
&=-\oint_\mathcal{L}\Psi_m\ dL'_m-\int_\mathcal{S} v^f_k\ dA'_k=-\oint_\mathcal{L}\Psi_i\ dL'_i-\Omega^f
\end{align}
Note that there is an error in Po-Lazar 2014, where the first term in the last equation has the wrong sign.
We now need to find the vector potential $\Psi_i$ and the fictitious vector field $v_i^f$. To do this we consider the auxiliary curve (Dirac string) $\mathcal{D}$, starting from $\mathbf x$ and ending at a point at infinity. Using the Dirac string, the fictitious vector can be found as
\begin{align}
v^f_{k}(\mathbf{R})=\int_\mathcal{D}v_{m,m}(\mathbf{R}+\mathbf{s})ds_k
=\int_\mathcal{D}\left(-\frac{1}{2}\Delta\Delta |\mathbf{x}+\mathbf{s}|\right)ds_k
=4\pi\int_\mathcal{D}\delta(\mathbf{R}+\mathbf{s})ds_k
\end{align}
The aforementioned property of $\mathbf v^f$ can be verified as follows:
\begin{align}
v^f_{k,k}(\mathbf{R})
&=\frac{\partial}{\partial x_k}\int_\mathcal{D}v_{m,m}(\mathbf{R}+\mathbf{s})ds_k
=\int_\mathcal{D}\frac{\partial}{\partial x_k}v_{m,m}(\mathbf{R}+\mathbf{s})ds_k\nonumber\\
&=\int_\mathcal{D}\frac{\partial}{\partial s_k}v_{m,m}(\mathbf{R}+\mathbf{s})ds_k
=\left[v_{m,m}(\mathbf{R}+\mathbf{s})\right]_\mathbf{0}^\infty=-v_{m,m}(\mathbf{R})
\end{align}

Knowing the fictitious vector, the vector potential can be found observing that  
\begin{align}
-\Delta \Psi_i=\epsilon_{ijk}(v_k+v^f_k)_{,j}=\epsilon_{ijk}v^f_{k,j}=-\epsilon_{ijk}\partial_j\int_\mathcal{D}\frac{1}{2}\Delta\Delta |\mathbf{R}+\mathbf{s}|ds_k
\end{align}
Therefore
\begin{align}
\Psi_i(\mathbf R)=\epsilon_{ijk}\int_\mathcal{D}\frac{1}{2}\partial_j\Delta |\mathbf{R}+\mathbf{s}|ds_k=-\epsilon_{ijk}\int_\mathcal{D}\frac{R_j+s_j}{|\mathbf{R}+\mathbf{s}|^3}ds_k
\end{align}
Choosing the Dirac string to be a straight line with unit direction $\hat{\mathbf{s}}$, the expression above becomes:
\begin{align}
\Psi_i(\mathbf R)&
=-\epsilon_{ijk}\int_0^\infty\frac{R_j+\alpha \hat{s}_j}{|\mathbf{R}+\alpha\hat{\mathbf{s}}|^3}\hat{s}_k\ d\alpha
=-\epsilon_{ijk}R_j\hat{s}_k\int_0^\infty\frac{1}{|\mathbf{R}+\alpha\hat{\mathbf{s}}|^3}\ d\alpha\nonumber\\
&=-\epsilon_{ijk}R_j\hat{s}_k\left[\frac{\alpha+\mathbf{R}\cdot\hat{\mathbf{s}}}{\left(R^2-(\mathbf{R}\cdot\hat{\mathbf{s}})^2\right)|\mathbf R+\alpha\hat{\mathbf s}|}\right]_0^\infty\nonumber\\
&=-\epsilon_{ijk}R_j\hat{s}_k\left[\frac{1}{R^2-(\mathbf{R}\cdot\hat{\mathbf{s}})^2}
-\frac{\mathbf{R}\cdot\hat{\mathbf{s}}}{\left(R^2-(\mathbf{R}\cdot\hat{\mathbf{s}})^2\right)R}\right]\nonumber\\
&=-\epsilon_{ijk}R_j\hat{s}_k
\frac{R-\mathbf{R}\cdot\hat{\mathbf{s}}}{\left(R^2-(\mathbf{R}\cdot\hat{\mathbf{s}})^2\right)R}
=-\frac{\epsilon_{ijk}R_j\hat{s}_k}{R\left(R+\mathbf{R}\cdot\hat{\mathbf{s}}\right)}
\end{align}
In vector form this reads
\begin{align}
\mathbf{\Psi}(\mathbf{x})=-\frac{\mathbf{R}\times\hat{\mathbf{s}}}{R\left(R+\mathbf{R}\cdot\hat{\mathbf{s}}\right)}
\end{align}

Finally, the Burgers equation becomes
\begin{align}
 \mathbf{u}(\mathbf x)
 &=-\frac{\mathbf{ b}}{4\pi}\left(-\oint_\mathcal{L}\Psi_i(\mathbf{R})\ dL'_i-\Omega^f\right)-\frac{1}{8\pi(1-\nu)}\oint_\mathcal{L}\frac{1}{R}\left\{\ 
 \left(1-2\nu\right) \mathbf{ b}\times\hat{\mathbf{ \xi}}'
+ \left[\hat{\mathbf{ R}}\cdot\left(\mathbf{ b}\times\hat{\mathbf{ \xi}}' \right) \right]\hat{\mathbf{ R}}  \right\}\dL'\nonumber\\
&=\frac{\mathbf{ b}\Omega^f}{4\pi}
-\frac{\mathbf{ b}}{4\pi}\oint_\mathcal{L}\frac{(\mathbf{R}\times\hat{\mathbf{s}})\cdot\hat{\mathbf{\xi}}'}{R\left(R+\mathbf{R}\cdot\hat{\mathbf{s}}\right)}\ dL'
-\frac{1}{8\pi(1-\nu)}\oint_\mathcal{L}\frac{1}{R}\left\{\ 
 \left(1-2\nu\right) \mathbf{ b}\times\hat{\mathbf{ \xi}}'
+ \left[\hat{\mathbf{ R}}\cdot\left(\mathbf{ b}\times\hat{\mathbf{ \xi}}' \right) \right]\hat{\mathbf{ R}}  \right\}\dL'\nonumber\\
&=\mathbf{b}^f(\mathbf x)
-\frac{1}{8\pi(1-\nu)}\oint_\mathcal{L}   
\frac{1}{R}\left\{\ \frac{2(1-\nu)(\hat{\mathbf{R}}\times\hat{\mathbf{s}})\cdot\hat{\mathbf{\xi}}'}{1+\hat{\mathbf{R}}\cdot\hat{\mathbf{s}}}\mathbf{ b}
+ \left(1-2\nu\right) \mathbf{ b}\times\hat{\mathbf{ \xi}}'
+ \left[\hat{\mathbf{ R}}\cdot\left(\mathbf{ b}\times\hat{\mathbf{ \xi}}' \right) \right]\hat{\mathbf{ R}}  \right\}\dL'\nonumber\\
&=\mathbf{b}^f(\mathbf x)
+\frac{1}{8\pi(1-\nu)}\oint_\mathcal{L}   
\frac{1}{R}\left\{\ \frac{2(1-\nu)(\hat{\mathbf{s}}\times\hat{\mathbf{R}})\cdot\hat{\mathbf{\xi}}'}{1+\hat{\mathbf{R}}\cdot\hat{\mathbf{s}}}\mathbf{ b}
+ \left(1-2\nu\right) \hat{\mathbf{ \xi}}'\times \mathbf{ b}
+ \left[\hat{\mathbf{ R}}\cdot\left(\hat{\mathbf{ \xi}}'\times\mathbf{ b} \right) \right]\hat{\mathbf{ R}}  \right\}\dL'\nonumber\\
\end{align}

Notice that
\begin{align}
\mathbf{b}^f(\mathbf x)
&=\frac{\mathbf{ b}\Omega^f}{4\pi}
=\frac{\mathbf{ b}}{4\pi}\int_\mathcal{S} v^f_k(\mathbf{R})\ dA'_k
=\frac{\mathbf{ b}}{4\pi}\int_\mathcal{S} 4\pi\int_\mathcal{D}\delta(\mathbf{R}+\mathbf{s})ds_k\ dA'_k\nonumber\\
&=\begin{cases}
+\mathbf{b}&\mbox{if the Dirac string crosses the slip surface positively}\\
-\mathbf{b}&\mbox{if the Dirac string crosses the slip surface negatively}\\
\mathbf{0}&\mbox{if the Dirac string does not cross the slip surface }
\end{cases}
\end{align}

%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Multipole expansion}

\subsubsection{Stress field}
\begin{align}
\sigma_{ij}=\oint_\mathcal{L}S_{ijkl}R(\mathbf x-\mathbf x')b'_k\xi'_l\ dL'
\end{align}
Now let $\mathbf{x'}=\mathbf{x}^c-\tilde{\mathbf{x}}$, then
\begin{align}
\sigma_{ij}=\oint_\mathcal{L}S_{ijkl}R(\mathbf x-\mathbf x^c+\tilde{\mathbf{x}})b'_k\xi'_l\ dL'
\end{align}
Now assume 
\begin{align}
|\tilde{\mathbf{x}}|\ll |\mathbf x-\mathbf x^c|
\end{align}
then, expanding $R$ for $\tilde{\mathbf{x}}\rightarrow0$ yields
\begin{align}
R(\mathbf x-\mathbf x^c+\tilde{\mathbf{x}})\approx R(\mathbf x-\mathbf x^c)+\partial_pR(\mathbf x-\mathbf x^c)\tilde{x}_p+\ldots
\end{align}
and
\begin{align}
\sigma_{ij}=S_{ijkl}R(\mathbf x-\mathbf x^c)\oint_\mathcal{L}b'_k\xi'_l\ dL'+S_{ijkl}\partial_pR(\mathbf x-\mathbf x^c)\oint_\mathcal{L}\tilde{x}_pb'_k\xi'_l+\ldots
\end{align}

First order expansion:
\begin{align}
\bm\sigma^0(\bm x)=\frac{\mu}{4\pi(1-\nu)R^2}&\left\{
(1-\nu)\left[\hat{\bm\xi}'\otimes(\bm b\times\hat{\bm R})+(\bm b\times\hat{\bm R})\otimes\hat{\bm\xi}'\right] 
+\left[(\hat{\bm \xi}'\times\bm b)\otimes\hat{\bm R}+\hat{\bm R}\otimes(\hat{\bm \xi}'\times\bm b)\right] \right. \nonumber\\
&\left.+\hat{\bm R}\cdot(\bm b\times\hat{\bm\xi}')\left[3\hat{\bm R}\otimes\hat{\bm R}+\bm I \right]
\right\}
\end{align}
Letting
\begin{align}
(\bm b\times\hat{\bm R})\otimes\hat{\bm\xi})_{ij}=\epsilon_{ikm}b_kR_m\xi_j=\epsilon_{ikm}R_m\alpha_{kj}=\mathbf{S}\cdot\mathbf{\alpha}
\end{align}
\begin{align}
\mathbf{S}=\left[\begin{array}{ccc}
0&R_3&-R_2\\
-R_3&0&R_1\\
R_2&-R_1&0
\end{array}\right]
\end{align}
\begin{align}
\bm b\times\hat{\bm \xi}'=\epsilon_{ikm}b_k\xi_m=a_i
\end{align}
\begin{align}
\mathbf{a}=\left[\begin{array}{c}
\alpha_{23}-\alpha_{32}\\
\alpha_{31}-\alpha_{13}\\
\alpha_{12}-\alpha_{21}
\end{array}\right]
\end{align}
we obtain
\begin{align}
\bm\sigma^0(\bm x)=\frac{\mu}{4\pi(1-\nu)R^2}&\left\{
(1-\nu)\left[(\mathbf{S}\cdot\mathbf{\alpha})^T+\mathbf{S}\cdot\mathbf{\alpha}\right] 
-\left[\mathbf{a}\otimes\hat{\bm R}+\hat{\bm R}\otimes\mathbf{a}\right] \right. \nonumber\\
&\left.+(\hat{\bm R}\cdot\bm a)\left[3\hat{\bm R}\otimes\hat{\bm R}+\bm I \right]
\right\}
\end{align}

\subsubsection{Displacement field}
\begin{align}
 \mathbf{u}(\mathbf x)
&=\mathbf{b}^f(\mathbf x)
+\frac{1}{8\pi(1-\nu)}  \frac{1}{R}
\left\{\ \bm\alpha\cdot\frac{2(1-\nu)(\hat{\mathbf{s}}\times\hat{\mathbf{R}})}{1+\hat{\mathbf{R}}\cdot\hat{\mathbf{s}}}
- \left(1-2\nu\right) \bm a
- \left(\hat{\mathbf{ R}}\cdot\bm a \right)\hat{\mathbf{ R}}  \right\}
\end{align}

\subsubsection{Interaction Energy}

\begin{align}
E_I=-\frac{\mu}{4\pi(1-\nu)}\oint_{\mathcal{L}_{2}}\oint_{\mathcal{L}_{1}}&\frac{1}{R}\left\{\left[(1-\nu)\left(\bm b_{1}\cdot\hat{\bm \xi}_1\right)\left(\bm b_{2}\cdot\hat{\bm \xi}_{2}\right)
+2\nu\left( \bm b_1\cdot\hat{\bm \xi}_2\right)\left(\bm b_2\cdot\hat{\bm \xi}_1\right)
-2\left(\bm b_1\cdot{\bm b}_2\right)\left( \hat{\bm\xi}_1\cdot\hat{\bm \xi}_2\right)
\right]\right.\nonumber\\
&\left.+\left( \hat{\bm\xi}_1\cdot\hat{\bm \xi}_2\right) \left[\left(\bm b_1\cdot\bm b_2\right)-\left(\bm b_1\cdot\hat{\bm R}\right)\left(\bm b_2\cdot\hat{\bm R}\right)\right]\right\} dL_{1} dL_{2}
\label{interaction_energy_loop_vector}
\end{align}

\begin{align}
E_I=-\frac{\mu}{4\pi(1-\nu)}\oint_{\mathcal{L}_{2}}\oint_{\mathcal{L}_{1}}&\frac{1}{R}\left\{(1-\nu)\left(\bm b_{1}\cdot\hat{\bm \xi}_1\right)\left(\bm b_{2}\cdot\hat{\bm \xi}_{2}\right)
+2\nu\left( \bm b_1\cdot\hat{\bm \xi}_2\right)\left(\bm b_2\cdot\hat{\bm \xi}_1\right)
-\left(\bm b_1\cdot{\bm b}_2\right)\left( \hat{\bm\xi}_1\cdot\hat{\bm \xi}_2\right)
\right.\nonumber\\
&\left. -\left( \hat{\bm\xi}_1\cdot\hat{\bm \xi}_2\right)\left(\bm b_1\cdot\hat{\bm R}\right)\left(\bm b_2\cdot\hat{\bm R}\right)\right\} dL_{1} dL_{2}
\label{interaction_energy_loop_vector}
\end{align}


%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Straight segments}
For a straight segment starting at $\bm A$ and ending at $\bm B$, it is useful to preliminary compute the function
\begin{align}
q(\bm x)=\int_{\bm A}^{\bm B}R_a\ d\ell'
\end{align}
where $R_a=\sqrt{\bm R\cdot\bm R+a^2}$, $\bm R=\bm x-\bm x'$. Integration is performed on the primed variable along the segment $\bm A\bm B$. This can be parametrized as a function of a scalar variable $u$ as
\begin{align}
\bm x'(u)=\bm A(1-u)+\bm Bu=\bm A+(\bm B-\bm A)u\hspace{1cm} u\in[0,1]
\end{align}
Therefore
\begin{align}
q(\bm x)&=L\int_0^1\sqrt{[(\bm A-\bm x)+(\bm B-\bm A)u]^2+a^2}\ du\nonumber\\
&=L\int_0^1\sqrt{(\bm B-\bm A)^2u^2+2(\bm A-\bm x)\cdot(\bm B-\bm A)u+(\bm A-\bm x)^2+a^2}\ du
\end{align}
Now
\begin{align}
\int\sqrt{du^2+bu+c}\ du=\left(\frac{b}{4d}+\frac{u}{2}\right)\sqrt{du^2+bu+c}+\frac{4dc-b^2}{8d^\frac{3}{2}}\ln\left(\frac{2du+b}{\sqrt{d}}+2\sqrt{du^2+bu+c}\right)
\end{align}
So
\begin{align}
\int_0^1\sqrt{du^2+bu+c}\ du=&\frac{2d+b}{4d}\sqrt{d+b+c}-\frac{b}{4d}\sqrt{c}+\frac{4dc-b^2}{8d^\frac{3}{2}}\ln\left(\frac{\frac{2d+b}{\sqrt{d}}+2\sqrt{d+b+c}}{\frac{b}{\sqrt{d}}+2\sqrt{c}}\right)
\end{align}

Note that in our case
\begin{align}
d&=(\bm B-\bm A)^2=L^2\\
b&=2(\bm A-\bm x)\cdot(\bm B-\bm A)=2L(\bm A-\bm x)\cdot\hat{\bm\xi}\\
c&=(\bm A-\bm x)^2+a^2\\
d+b+c&=(\bm B-\bm x)^2+a^2\\
2d+b&=2(\bm B-\bm x)\cdot(\bm B-\bm A)=2L(\bm B-\bm x)\cdot{\hat{\bm \xi}}\\
4dc-b^2&=4(\bm B-\bm A)^2(\bm A-\bm x)^2-[2(\bm A-\bm x)\cdot(\bm B-\bm A)]^2+4da^2\nonumber\\
&=4L^2[(\bm A-\bm x)^2-((\bm A-\bm x)\cdot\hat{\bm\xi})^2+a^2]\nonumber\\
&=4L^2[(\bm A-\bm B+\bm B-\bm x)^2-((\bm A-\bm x)\cdot\hat{\bm\xi})^2+a^2]\nonumber\\
&=4L^2[(\bm A-\bm B)^2+2(\bm A-\bm B)\cdot(\bm B-\bm x)+(\bm B-\bm x)^2-((\bm A-\bm B)\cdot\hat{\bm\xi}+(\bm B-\bm x)\cdot\hat{\bm\xi})^2+a^2]\nonumber\\
&=4L^2[L^2-2L\hat{\bm\xi}\cdot(\bm B-\bm x)+(\bm B-\bm x)^2-(-L+(\bm B-\bm x)\cdot\hat{\bm\xi})^2+a^2]\nonumber\\
&=4L^2[L^2-2L\hat{\bm\xi}\cdot(\bm B-\bm x)+(\bm B-\bm x)^2-L^2+2L(\bm B-\bm x)\cdot\hat{\bm\xi}-((\bm B-\bm x)\cdot\hat{\bm\xi})^2+a^2]\nonumber\\
&=4L^2[(\bm B-\bm x)^2-((\bm B-\bm x)\cdot\hat{\bm\xi})^2+a^2]\nonumber\\
&=4L^2\rho^2_a
\end{align}
where 
\begin{align}
\rho^2_a=(\bm B-\bm x)^2-((\bm B-\bm x)\cdot\hat{\bm\xi})^2+a^2=(\bm A-\bm x)^2-((\bm A-\bm x)\cdot\hat{\bm\xi})^2+a^2
\end{align}
$\rho^2$ is the regularized distance of $\bm x$ from the line passing through $\bm A$ and $\bm B$.

%\begin{align}
%\left(\frac{b}{4\, a} + \frac{1}{2}\right)\, \sqrt{a + b + c} - \left(\frac{b}{4\, a} - \frac{1}{2}\right)\, \sqrt{a - b + c} + \frac{\ln\!\left(\frac{a + \frac{b}{2}}{\sqrt{a}} + \sqrt{a + b + c}\right)\, \left(a\, c - \frac{b^2}{4}\right)}{2\, a^{\frac{3}{2}}} - \frac{\ln\!\left(\sqrt{a - b + c} - \frac{a - \frac{b}{2}}{\sqrt{a}}\right)\, \left(a\, c - \frac{b^2}{4}\right)}{2\, a^{\frac{3}{2}}}
%\end{align}


Therefore
\begin{align}
\int_0^1\sqrt{du^2+bu+c}\ du
%\frac{2a+b}{4a}\sqrt{a+b+c}-\frac{b}{4a}\sqrt{c}+\frac{4ac-b^2}{8a^\frac{3}{2}}\ln\left(\frac{\frac{2a+b}{\sqrt{a}}+2\sqrt{a+b+c}}{\frac{b}{\sqrt{a}}+2\sqrt{c}}\right)\nonumber\\
%&-\frac{4ac-b^2}{8a^\frac{3}{2}}\ln\left(\frac{b}{\sqrt{a}}+2\sqrt{c}\right)\nonumber\\
=&\frac{(\bm B-\bm x)\cdot(\bm B-\bm A)}{2(\bm B-\bm A)^2}\sqrt{(\bm B-\bm x)^2+a^2}-\frac{(\bm A-\bm x)\cdot(\bm B-\bm A)}{2(\bm B-\bm A)^2}\sqrt{(\bm A-\bm x)^2+a^2}\nonumber\\
&+\frac{4dc-b^2}{8L^3}\ln\left(\frac{\frac{2(\bm B-\bm x)\cdot(\bm B-\bm A)}{\sqrt{d}}+2\sqrt{(\bm B-\bm x)^2+a^2}}{\frac{2(\bm A-\bm x)\cdot(\bm B-\bm A)}{\sqrt{d}}+2\sqrt{(\bm A-\bm x)^2+a^2}}\right)\nonumber\\
=&\frac{(\bm B-\bm x)\cdot\hat{\bm\xi}}{2L}\sqrt{(\bm B-\bm x)^2+a^2}-\frac{(\bm A-\bm x)\cdot\hat{\bm\xi}}{2L}\sqrt{(\bm A-\bm x)^2+a^2}\nonumber\\
&+\frac{\rho^2_a}{2L}\ln\left(\frac{(\bm B-\bm x)\cdot\hat{\bm\xi}+\sqrt{(\bm B-\bm x)^2+a^2}}{(\bm A-\bm x)\cdot\hat{\bm\xi}+\sqrt{(\bm A-\bm x)^2+a^2}}\right)
\end{align}

If we define
\begin{align}
f(\bm z)
&=\frac{\bm z\cdot\hat{\bm\xi}}{2}z_a + \frac{\rho^2_a}{2}\ln\left(\bm z\cdot\hat{\bm\xi}+z_a\right)\nonumber\\
&=\frac{\bm z\cdot\hat{\bm\xi}}{2}z_a + \frac{\rho^2_a}{2}\ln\left(\bm Y_a\cdot\hat{\bm \xi}\right)
\end{align}
and
\begin{align}
\bm Y_a&=\bm z+z_a\hat{\bm\xi}\\
\rho_a^2&=\bm \rho_a\cdot\bm \rho_a=z^2-(\bm z\cdot\hat{\bm \xi})^2+a^2\\
\bm \rho_a&=\bm z-(\bm z\cdot\hat{\bm\xi}\pm a)\hat{\bm\xi}
\end{align}
then  we have
\begin{align}
q(\bm x)=f(\bm B-\bm x)-f(\bm A-\bm x)
\end{align}

Now consider the following identities:
\begin{align}
%\rho^2(\bm z)&=\bm \rho(\bm z)\cdot\bm \rho(\bm z)=z^2-(\bm z\cdot\hat{\bm \xi})^2\nonumber\\
\bm\rho_a\cdot\hat{\bm\xi}&=\mp a\\
%\rho_i{z}_i&=z^2-(\bm z\cdot\hat{\bm \xi})^2=\rho^2\\
\bm Y_a\cdot\hat{\bm \xi}&=\bm z\cdot\hat{\bm\xi}+z_a\\
Y^2_a&=2z_a\bm Y_a\cdot\hat{\bm \xi}-a^2\\
%\bm Y_a\cdot\bm z&=z(z+\bm z\cdot\hat{\bm\xi})=z\bm Y\cdot\hat{\bm \xi}\\
%\end{align}
%\begin{align}
\frac{\partial \rho_{ai}}{\partial z_j}&=\delta_{ij}-\hat{\xi}_i\hat{\xi}_j\\
%\end{align}
%\begin{align}
\frac{\partial \rho^2_a}{\partial z_i}&=2\rho_{ak} \frac{\partial  \rho_{ak}}{\partial z_i}=2\rho_{ak}\left(\delta_{ki}-\hat{\xi}_i\hat{\xi}_k\right)
%=2\left(\rho_i-\hat{\xi}_i\hat{\xi}_k\rho_k\right)\nonumber\\
%&=2\left[z_i-z_k\hat{\xi}_k\hat{\xi}_i-\hat{\xi}_i\left(z_m\hat{\xi}_m-z_k\hat{\xi}_k\hat{\xi}_m\hat{\xi}_m\right)\right]
=2(\underbrace{z_i-(\bm z\cdot\hat{\bm \xi})\hat{ \xi}_i}_{\rho_i})=2\rho_{i}\\
\frac{\partial \rho_{i}}{\partial z_j}&=\delta_{ij}-\hat{\xi}_i\hat{\xi}_j\\
%\end{align}
%\begin{align}
\frac{\partial Y_{ai}}{\partial z_j}&=\delta_{ij}+\frac{z_j\hat{\xi}_i}{z_a}\\
\frac{\partial (\bm Y_a \cdot \hat{\bm \xi})}{\partial z_i}&=\frac{ Y_{ai}}{z_a}\\
\frac{\partial }{\partial z_i}\ln (\bm Y_a \cdot \hat{\bm \xi})&=\frac{ Y_{ai}}{z_a \bm Y_a \cdot \hat{\bm \xi}}
\end{align}

First derivative
\begin{align}
\frac{\partial f}{\partial  z_i}
&=\frac{z_a\hat{\xi}_i}{2}+\frac{z_p\hat{\xi}_p z_i}{2z_a}+\rho_i\ln(\bm Y_a \cdot \hat{\bm \xi})+\frac{\rho^2_a}{2}\frac{ Y_{ai}}{z_a \bm Y_a \cdot \hat{\bm \xi}}\nonumber\\
&=\frac{z_a\hat{\xi}_i}{2}+\frac{z_p\hat{\xi}_p z_i}{2z_a}+\rho_i\ln(\bm Y_a \cdot \hat{\bm \xi})+\frac{(z^2-(z_q\hat{\xi}_q)^2+a^2)}{2}\frac{ Y_{ai}}{z_a (z_a+z_p\hat{\xi}_p)}\nonumber\\
&=\frac{z_a\hat{\xi}_i}{2}+\frac{z_p\hat{\xi}_p z_i}{2z_a}+\rho_i\ln(\bm Y_a \cdot \hat{\bm \xi})+\frac{(z_a-z_q\hat{\xi}_q)}{2}\frac{ Y_{ai}}{z_a }\nonumber\\
&=\frac{z_a^2\hat{\xi}_i+z_p\hat{\xi}_p z_i+(z_a-z_q\hat{\xi}_q)(z_i+z_a\hat{\xi}_i)}{2z_a}+\rho_i\ln(\bm Y_a \cdot \hat{\bm \xi})\nonumber\\
&=\frac{\rho_i}{2}+z_a\hat{\xi}_i+\rho_i\ln(\bm Y_a \cdot \hat{\bm \xi})
\end{align}


Second derivative
\begin{align}
\frac{\partial^2 f}{\partial  z_i\partial  z_j}
&=
\frac{\rho_{i,j}}{2}
+\frac{z_j}{z_a}\hat{\xi}_i
+ \rho_{i,j}\ln\left(\bm Y_a \cdot \hat{\bm \xi}\right)
+ \frac{\rho_iY_{aj}}{z_a \bm Y_a \cdot \hat{\bm \xi}}\nonumber\\
%
&=
\frac{ \delta_{ij}-\hat{\xi}_i\hat{\xi}_j}{2}
+\frac{z_j}{z_a}\hat{\xi}_i
+ (\delta_{ij}-\hat{\xi}_i\hat{\xi}_j)\ln\left(\bm Y_a \cdot \hat{\bm \xi}\right)
+ \frac{\rho_iY_{aj}}{z_a \bm Y_a \cdot \hat{\bm \xi}}\nonumber\\
&=
\frac{ \delta_{ij}-\hat{\xi}_i\hat{\xi}_j}{2}
+ (\delta_{ij}-\hat{\xi}_i\hat{\xi}_j)\ln\left(\bm Y_a \cdot \hat{\bm \xi}\right)
+ \frac{\rho_iY_{aj}+z_j\hat{\xi}_i \bm Y_a \cdot \hat{\bm \xi}}{z_a \bm Y_a \cdot \hat{\bm \xi}}
\nonumber\\
&=
\frac{ \delta_{ij}-\hat{\xi}_i\hat{\xi}_j}{2}
+ (\delta_{ij}-\hat{\xi}_i\hat{\xi}_j)\ln\left(\bm Y_a \cdot \hat{\bm \xi}\right)
+ \frac{1}{ \bm Y_a \cdot \hat{\bm \xi}}\left(\frac{z_iz_j}{z_a}+z_i\hat{\xi}_j+z_j\hat{\xi}_i-z_q\hat{\xi}_q\hat{\xi}_i\hat{\xi}_j\right)
\end{align}

\begin{align}
\frac{\partial^2 f}{\partial  z_p\partial  z_p}
&=1+ 2\ln\left(\bm Y_a \cdot \hat{\bm \xi}\right)+ \frac{1}{ \bm Y_a \cdot \hat{\bm \xi}}\left(\frac{z^2}{z_a}+\bm z\cdot\hat{\bm\xi}\right)\nonumber\\
&=1+ 2\ln\left(\bm Y_a \cdot \hat{\bm \xi}\right)+ \frac{1}{ \bm Y_a \cdot \hat{\bm \xi}}\left(z_a+\bm z\cdot\hat{\bm\xi}-\frac{a^2}{z_a}\right)\nonumber\\
&=2+ 2\ln\left(\bm Y_a \cdot \hat{\bm \xi}\right)-\frac{a^2}{z_a \bm Y_a \cdot \hat{\bm \xi}}
\label{laplacianFz}
\end{align}

Third derivative
\begin{align}
\frac{\partial^3 f}{\partial  z_i\partial  z_j z_m}
&=\frac{\delta_{jm}Y_{ai}+\delta_{im}Y_{aj}+\delta_{ij}Y_{am}}{z_a(\bm Y_a\cdot \hat{\bm \xi})}\\
&+\frac{1}{\bm Y_a\cdot \hat{\bm \xi}}\left(\frac{\bm z\cdot{\hat{\bm \xi}}}{\bm Y_a\cdot \hat{\bm \xi}}-2\right)\hat{\xi}_i\hat{\xi}_j\hat{\xi}_m\\
&-\frac{1}{z_a^2\bm Y_a\cdot \hat{\bm \xi}}\left(\frac{1}{\bm Y_a\cdot \hat{\bm \xi}}+\frac{1}{z_a}\right)z_iz_jz_m\\
&-\frac{\hat{\xi}_iz_mY_{aj}+\hat{\xi}_jz_iY_{am}+\hat{\xi}_mz_jY_{ai}}{z_a(\bm Y_a\cdot \hat{\bm \xi})^2}\\
\end{align}

Letting $i=j$
\begin{align}
\frac{\partial^3 f}{\partial  z_p\partial  z_p z_m}
&=\frac{5Y_{am}}{z_a(\bm Y_a\cdot \hat{\bm \xi})}\\
&+\frac{1}{\bm Y_a\cdot \hat{\bm \xi}}\left(\frac{\bm z\cdot{\hat{\bm \xi}}}{\bm Y_a\cdot \hat{\bm \xi}}+\frac{a^2}{z_a\bm Y_a\cdot \hat{\bm \xi}}-2\right)\hat{\xi}_m\\
&-\frac{1}{\bm Y_a\cdot \hat{\bm \xi}}\left(\frac{1}{\bm Y_a\cdot \hat{\bm \xi}}+\frac{1}{z_a}\right)\left(1-\frac{a^2}{z_a^2}\right)z_m\\
&-\frac{z_a+2(\bm z\cdot\hat{\bm \xi})}{z_a(\bm Y_a\cdot \hat{\bm \xi})^2}Y_{am}\nonumber\\
%
&=\frac{5Y_{am}}{z_a(\bm Y_a\cdot \hat{\bm \xi})}\\
&-\frac{z^2+z_a \bm Y_a\cdot \hat{\bm \xi}}{z_a(\bm Y_a\cdot \hat{\bm \xi})^2}\hat{\xi}_m\\
&-\frac{z_a+\bm Y_a\cdot \hat{\bm \xi}}{z_a(\bm Y_a\cdot \hat{\bm \xi})^2}\left(1-\frac{a^2}{z_a^2}\right)z_m\\
&-\frac{z_a+2(\bm z\cdot\hat{\bm \xi})}{z_a(\bm Y_a\cdot \hat{\bm \xi})^2}Y_{am}\\
%
&=\frac{5Y_{am}}{z_a(\bm Y_a\cdot \hat{\bm \xi})}\\
%&-\frac{z^2+z_a \bm Y_a\cdot \hat{\bm \xi}}{z_a(\bm Y_a\cdot \hat{\bm \xi})^2}\hat{\xi}_m\\
%&-\frac{z_a+\bm Y_a\cdot \hat{\bm \xi}}{z_a(\bm Y_a\cdot \hat{\bm \xi})^2}\left(1-\frac{a^2}{z_a^2}\right)z_m\\
&-\frac{z^2+z_a\bm Y_a\cdot \hat{\bm \xi}}{z_a^2(\bm Y_a\cdot \hat{\bm \xi})^2}Y_{am}+\frac{a^2}{z_a^3 \bm Y_a\cdot \hat{\bm \xi}}z_m\nonumber\\
&-\frac{z_a+2(\bm z\cdot\hat{\bm \xi})}{z_a(\bm Y_a\cdot \hat{\bm \xi})^2}Y_{am}\nonumber\\
%
&=\left(\frac{2}{z_a\bm Y_a\cdot \hat{\bm \xi}}+\frac{a^2}{z_a^2(\bm Y_a\cdot \hat{\bm \xi})^2}\right)Y_{am}+\frac{a^2}{z_a^3 \bm Y_a\cdot \hat{\bm \xi}}z_m
\end{align}



%Combining terms and using $\rho_m=Y_m-(\bm Y\cdot\hat{\bm \xi})\hat{\xi}_m$
%\begin{align}
%\frac{\partial^3 f}{\partial  z_p\partial  z_p z_m}
%&=\frac{1}{z(\bm Y\cdot \hat{\bm \xi})}\left(3-\frac{\bm z\cdot\hat{\bm\xi}}{(\bm Y\cdot \hat{\bm \xi})}\right)Y_m-\frac{1}{\bm Y\cdot \hat{\bm \xi}}\left(\frac{\rho_m}{\bm Y\cdot \hat{\bm \xi}}+\hat{\xi}_m\right)\nonumber\\
%&=\frac{2Y_m}{z\bm Y\cdot \hat{\bm \xi}}
%\end{align}

Since   $\epsilon_{klm}\hat{\xi}_l\hat{\xi}_m=0$, then $\epsilon_{klm}\hat{\xi}_lY_m=\epsilon_{klm}\hat{\xi}_lY_{am}=\epsilon_{klm}\hat{\xi}_l\rho_m=\epsilon_{klm}\hat{\xi}_lz_m$. Therefore 
\begin{align}
\epsilon_{klm}\hat{\xi}_l\frac{\partial^3 f}{\partial  z_i\partial  z_j z_m}
&=\frac{\epsilon_{klj}\hat{\xi}_lY_{ai}+\epsilon_{kli}\hat{\xi}_lY_{aj}+\epsilon_{klm}\hat{\xi}_l\delta_{ij}Y_{am}}{z_a(\bm Y_a\cdot \hat{\bm \xi})}\\
&-\epsilon_{klm}\hat{\xi}_l\frac{1}{z_a^2\bm Y_a\cdot \hat{\bm \xi}}\left(\frac{1}{\bm Y_a\cdot \hat{\bm \xi}}+\frac{1}{z_a}\right)z_iz_jY_{am}\\
&-\frac{\epsilon_{klm}\hat{\xi}_l\hat{\xi}_iY_{am}Y_{aj}+\epsilon_{klm}\hat{\xi}_l\hat{\xi}_jz_iY_{am}}{z_a(\bm Y_a\cdot \hat{\bm \xi})^2}
\end{align}
and
\begin{align}
\epsilon_{klm}\hat{\xi}_l\frac{\partial^3 f}{\partial  z_p\partial  z_p z_m}&=\epsilon_{klm}\hat{\xi}_l\left(\frac{2}{z_a\bm Y_a\cdot \hat{\bm \xi}}+\frac{a^2}{z_a^2(\bm Y_a\cdot \hat{\bm \xi})^2}+\frac{a^2}{z_a^3 \bm Y_a\cdot \hat{\bm \xi}}\right)Y_{am}
\end{align}

Simplifying:
\begin{align}
\epsilon_{klm}\hat{\xi}_l\frac{\partial^3 f}{\partial  z_i\partial  z_j z_m}&=
\frac{\epsilon_{klj}\hat{\xi}_lY_{ai}+\epsilon_{kli}\hat{\xi}_lY_{aj}}{z_a(\bm Y_a\cdot \hat{\bm \xi})}\nonumber\\
&+\frac{\epsilon_{klm}\hat{\xi}_lY_{am}}{z_a(\bm Y_a\cdot \hat{\bm \xi})}\left[\delta_{ij}-\frac{z_a+\bm Y_a\cdot \hat{\bm \xi}}{z_a^2\bm Y_a\cdot \hat{\bm \xi}}z_iz_j-\frac{\hat{\xi}_iz_j+\hat{\xi}_jz_i+z_a\hat{\xi}_i\hat{\xi}_j}{\bm Y_a\cdot \hat{\bm \xi}}\right]\\
\end{align}


 
%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Stress field of a straight segment}


The stress field of the segment $\bm A\rightarrow\bm B$ is
\begin{align}
\sigma_{ij}(\bm x)=b_k\int_{\bm A}^{\bm B}S_{ijkl}R_a\ d\ell'_l
\end{align}
\begin{align}
S_{ijkl}=\frac{\mu}{8\pi}\left[\left(\delta_{il}\epsilon_{jmk}+\delta_{jl}\epsilon_{imk}\right)\partial_m\Delta+\frac{2}{1-\nu}\epsilon_{klm}\left(\partial_{i}\partial_j\partial_m-\delta_{ij}\partial_m\Delta\right)\right]
\end{align}
Now notice that differentiation is in $\bm x$, while integration is in $\bm x'$. Therefore they commute. 
\begin{align}
\sigma_{ij}(\bm x)
&=b_k\hat{\xi}_lS_{ijkl}q(\bm x)\nonumber\\
&=\hat{\xi}_lb_k\frac{\mu}{8\pi}\left[\left(\delta_{il}\epsilon_{jmk}+\delta_{jl}\epsilon_{imk}\right)\partial_m\Delta+\frac{2}{1-\nu}\epsilon_{klm}\left(\partial_{i}\partial_j\partial_m-\delta_{ij}\partial_m\Delta\right)\right]\left[f(\bm B-\bm x)-f(\bm A-\bm x)\right]\nonumber\\
&=\hat{\xi}_lb_k\frac{\mu}{8\pi}\left[\left(\delta_{il}\epsilon_{jmk}+\delta_{jl}\epsilon_{imk}\right)\partial_m\Delta+\frac{2}{1-\nu}\epsilon_{klm}\left(\partial_{i}\partial_j\partial_m-\delta_{ij}\partial_m\Delta\right)\right]\left[f(\bm z)\right]^{\bm z=\bm B-\bm x}_{\bm z=\bm A-\bm x}\nonumber\\
&=\frac{\mu}{4\pi(1-\nu)}\left[\frac{1-\nu}{2}\left(\hat{\xi}_ib_k\epsilon_{jmk}+\hat{\xi}_jb_k\epsilon_{imk}\right)\frac{\partial^3 f}{\partial z_p\partial z_p\partial z_m}+\epsilon_{klm}\hat{\xi}_lb_k\left(\frac{\partial^3 f}{\partial z_i\partial z_j\partial z_m}-\delta_{ij}\frac{\partial^3 f}{\partial z_p\partial z_p\partial z_m}\right)\right]^{\bm z=\bm A-\bm x}_{\bm z=\bm B-\bm x}
\label{stressStraightDerivation}
\end{align}
 
Plugging back in \eqref{stressStraightDerivation} we obtain
\begin{align}
\sigma_{ij}(\bm x)
=\frac{\mu}{4\pi(1-\nu)}&\left[\frac{1-\nu}{2}\left(\hat{\xi}_ib_k\epsilon_{jmk}+\hat{\xi}_jb_k\epsilon_{imk}\right)\left[\left(\frac{2}{z_a\bm Y_a\cdot \hat{\bm \xi}}+\frac{a^2}{z_a^2(\bm Y_a\cdot \hat{\bm \xi})^2}\right)Y_{am}+\frac{a^2}{z_a^3 \bm Y_a\cdot \hat{\bm \xi}}z_m\right]\right.\nonumber\\
&+\frac{\epsilon_{klj}b_k\hat{\xi}_lY_{ai}+\epsilon_{kli}b_k\hat{\xi}_lY_{aj}}{z_a(\bm Y_a\cdot \hat{\bm \xi})}\nonumber\\
&+\frac{\epsilon_{klm}b_k\hat{\xi}_lY_{am}}{z_a(\bm Y_a\cdot \hat{\bm \xi})}\left(\delta_{ij}-\frac{z_a+\bm Y_a\cdot \hat{\bm \xi}}{z_a^2\bm Y_a\cdot \hat{\bm \xi}}z_iz_j-\frac{\hat{\xi}_iz_j+\hat{\xi}_jz_i+z_a\hat{\xi}_i\hat{\xi}_j}{\bm Y_a\cdot \hat{\bm \xi}}\right)\nonumber\\
&\left.-\epsilon_{klm}b_k\hat{\xi}_lY_{am}\delta_{ij}\left(\frac{2}{z_a\bm Y_a\cdot \hat{\bm \xi}}+\frac{a^2}{z_a^2(\bm Y_a\cdot \hat{\bm \xi})^2}+\frac{a^2}{z_a^3 \bm Y_a\cdot \hat{\bm \xi}}\right)\right]^{\bm z=\bm A-\bm x}_{\bm z=\bm B-\bm x}
\end{align}
Factoring the term $z_a\bm Y_a\cdot \hat{\bm \xi}=(Y_a^2+a^2)/2$ we obtain
\begin{align}
\sigma_{ij}(\bm x)
=\frac{\mu}{4\pi(1-\nu)}&\left[\frac{2}{Y_a^2+a^2}\left\{(1-\nu)\left(\hat{\xi}_ib_k\epsilon_{jmk}+\hat{\xi}_jb_k\epsilon_{imk}\right)\left[\left(1+\frac{a^2}{Y_a^2+a^2}\right)Y_{am}+\frac{a^2}{2z_a^2 }z_m\right]\right.\right.\nonumber\\
&+\epsilon_{klj}b_k\hat{\xi}_lY_{ai}+\epsilon_{kli}b_k\hat{\xi}_lY_{aj}\nonumber\\
&\left.\left.-\epsilon_{klm}b_k\hat{\xi}_lY_{am}\left(\left(1+2\frac{a^2}{Y_a^2+a^2}+\frac{a^2}{z_a^2 }\right)\delta_{ij}+2\frac{z_a+\bm Y_a\cdot \hat{\bm \xi}}{z_a(Y_a^2+a^2)}z_iz_j+\frac{\hat{\xi}_iz_j+\hat{\xi}_jz_i+z_a\hat{\xi}_i\hat{\xi}_j}{\bm Y_a\cdot \hat{\bm \xi}}\right)
\right\}\right]^{\bm z=\bm A-\bm x}_{\bm z=\bm B-\bm x}
%\nonumber\\
%
%&\left.\left.-\epsilon_{klm}b_k\hat{\xi}_lY_{am}\delta_{ij}\left(2+\frac{a^2}{z_a\bm Y_a\cdot \hat{\bm \xi}}+\frac{a^2}{z_a^2 }\right)\right\}\right]^{\bm z=\bm A-\bm x}_{\bm z=\bm B-\bm x}
\end{align}


%\begin{align}
%\sigma_{ij}(\bm x)
%=\frac{\mu}{4\pi(1-\nu)}&\left[\frac{2}{Y^2}\left\{(1-\nu)\left(\hat{\xi}_i\epsilon_{jmk}Y_mb_k+\epsilon_{imk}Y_mb_k\hat{\xi}_j\right)\right.\right.\nonumber\\
%&+Y_i\epsilon_{jkl}b_k\hat{\xi}_l+\epsilon_{ikl}b_k\hat{\xi}_lY_j\nonumber\\
%&\left.\left.-\epsilon_{klm}b_k\hat{\xi}_lY_m\left(\delta_{ij}+2\frac{z+\bm Y\cdot \hat{\bm \xi}}{zY^2}z_iz_j+\frac{\hat{\xi}_iz_j+\hat{\xi}_jz_i+z\hat{\xi}_i\hat{\xi}_j}{\bm Y\cdot \hat{\bm \xi}}\right)\right\}\right]^{\bm z=\bm A-\bm x}_{\bm z=\bm B-\bm x}
%&\left.\left.-\epsilon_{klm}\hat{\xi}_lb_k\delta_{ij}\frac{2Y_m}{Y^2}\right\}\right]^{\bm z=\bm A-\bm x}_{\bm z=\bm B-\bm x}
%\end{align}
Inverting the order of evaluation, and changing the sign within the square bracket we have
\begin{align}
\sigma_{ij}(\bm x)
=\frac{\mu}{4\pi(1-\nu)}&\left[\frac{2}{Y_a^2+a^2}\left\{(1-\nu)\left(\hat{\xi}_ib_k\epsilon_{jkm}+\hat{\xi}_jb_k\epsilon_{ikm}\right)\left[\left(1+\frac{a^2}{Y_a^2+a^2}\right)Y_{am}+\frac{a^2}{2z_a^2 }z_m\right]\right.\right.\nonumber\\
&-(Y_{ai}\epsilon_{jkl}b_k\hat{\xi}_l+\epsilon_{ikl}b_k\hat{\xi}_lY_{aj})\nonumber\\
&\left.\left.-\epsilon_{klm}b_kY_{al}\hat{\xi}_m\left(\left(1+2\frac{a^2}{Y_a^2+a^2}+\frac{a^2}{z_a^2 }\right)\delta_{ij}+2\frac{z_a+\bm Y_a\cdot \hat{\bm \xi}}{z_a(Y_a^2+a^2)}z_iz_j+\frac{\hat{\xi}_iz_j+\hat{\xi}_jz_i+z_a\hat{\xi}_i\hat{\xi}_j}{\bm Y_a\cdot \hat{\bm \xi}}\right)
\right\}\right]^{\bm z=\bm B-\bm x}_{\bm z=\bm A-\bm x}
%\nonumber\\
%
%&\left.\left.-\epsilon_{klm}b_k\hat{\xi}_lY_{am}\delta_{ij}\left(2+\frac{a^2}{z_a\bm Y_a\cdot \hat{\bm \xi}}+\frac{a^2}{z_a^2 }\right)\right\}\right]^{\bm z=\bm A-\bm x}_{\bm z=\bm B-\bm x}
\end{align}

%\begin{align}
%\sigma_{ij}(\bm x)
%=\frac{\mu}{4\pi(1-\nu)}&\left[\frac{2}{Y^2}\left\{(1-\nu)\left(\hat{\xi}_i\epsilon_{jkm}b_kY_m+\epsilon_{ikm}b_kY_m\hat{\xi}_j\right)\right.\right.\nonumber\\
%&-\left(Y_i\epsilon_{jkl}b_k\hat{\xi}_l+\epsilon_{ikl}b_k\hat{\xi}_lY_j\right)\nonumber\\
%&\left.\left.-\epsilon_{klm}b_kY_l\hat{\xi}_m\left(\delta_{ij}+2\frac{z+\bm Y\cdot \hat{\bm \xi}}{zY^2}z_iz_j+\frac{\hat{\xi}_iz_j+\hat{\xi}_jz_i+z\hat{\xi}_i\hat{\xi}_j}{\bm Y\cdot \hat{\bm \xi}}\right)\right\}\right]^{\bm z=\bm B-\bm x}_{\bm z=\bm A-\bm x}
%&\left.\left.-\epsilon_{klm}\hat{\xi}_lb_k\delta_{ij}\frac{2Y_m}{Y^2}\right\}\right]^{\bm z=\bm A-\bm x}_{\bm z=\bm B-\bm x}
%\end{align}
It is more efficient to compute the stress field as
\begin{align}
\bm\sigma(\bm x)=\frac{\mu}{4\pi(1-\nu)}\left(\bm s(\bm x)+\bm s^T(\bm x)\right)
\end{align}
where
\begin{align}
\bm s(\bm x)=\tilde {\bm s}(\bm B-\bm x)-\tilde {\bm s}(\bm A-\bm x)
\end{align}
and
\begin{align}
\tilde{\bm s}(\bm z)
=\frac{2}{Y_a^2+a^2}&
\left\{
(1-\nu)\left(1+\frac{a^2}{Y_a^2+a^2}\right)\hat{\bm\xi}\otimes\left(\bm b\times \bm Y_a\right)\right.\nonumber\\
&+(1-\nu)\frac{a^2}{2z_a^2 }\hat{\bm\xi}\otimes\left(\bm b\times \bm z\right)\nonumber\\
&-\bm Y_a\otimes\left(\bm b\times\hat{\bm \xi}\right)\nonumber\\
&-\frac{\left[\left(\bm b\times\bm Y_a\right)\cdot\hat{\bm \xi}\right]}{\bm Y_a\cdot \hat{\bm \xi}}\hat{\bm\xi}\otimes\bm z\nonumber\\
&\left.-\frac{\left[\left(\bm b\times\bm Y_a\right)\cdot\hat{\bm \xi}\right]}{2}\left(\left(1+2\frac{a^2}{Y_a^2+a^2}+\frac{a^2}{z_a^2 }\right)\bm I+2\frac{z_a+\bm Y_a\cdot \hat{\bm \xi}}{z_a(Y_a^2+a^2)}\bm z\otimes\bm z+\frac{z_a}{\bm Y_a\cdot \hat{\bm \xi}}\hat{\bm\xi}\otimes\hat{\bm\xi}\right)\right\}%\right]^{\bm z=\bm B-\bm x}_{\bm z=\bm A-\bm x}
%&\left.\left.-\epsilon_{klm}\hat{\xi}_lb_k\delta_{ij}\frac{2Y_m}{Y^2}\right\}\right]^{\bm z=\bm A-\bm x}_{\bm z=\bm B-\bm x}
\end{align}
with
\begin{align}
\bm Y_a(\bm z)&=\bm z+z_a\hat{\bm\xi}\\
 Y^2_a(\bm z)&=2z_a\bm Y_a\cdot\hat{\bm \xi}-a^2\\
\end{align}

\subsubsection{Stress of a straight segment on a distant point}
Suppose that we want to compute the stress field of a segment $\bm A\bm B$ at a point $\bm x$, which is located at distance $d$ from the center $\bm C$ of the segment. Let the length of the segment be $AB=2L$, then
\begin{align}
\bm B-\bm x&=\bm C-\bm x+\bm C-\bm B=\bm C-\bm x-L\hat{\bm\xi}=d\left(\hat{\bm r}_c-\frac{L}{d}\hat{\bm\xi}\right)\\
\bm A-\bm x&=\bm C-\bm x+\bm C-\bm A=\bm C-\bm x+L\hat{\bm\xi}=d\left(\hat{\bm r}_c+\frac{L}{d}\hat{\bm\xi}\right)
\end{align}
where $\hat{\bm r}_c=(\bm C-\bm x)/\|\bm C-\bm x\|=(\bm C-\bm x)/d$. Therefore we have
\begin{align}
\bm s(\bm x)=\tilde {\bm s}\left(d\left(\hat{\bm r}_c-\frac{L}{d}\hat{\bm\xi}\right)\right)-
\tilde {\bm s}\left(d\left(\hat{\bm r}_c+\frac{L}{d}\hat{\bm\xi}\right)\right)
%\tilde {\bm s}(\bm A-\bm x)
\end{align}
%\begin{align}
%\bm s(\bm x)
%=\left[\frac{2}{Y^2}\right.&
%\left\{
%(1-\nu)\hat{\bm\xi}\otimes\left(\bm b\times \bm Y\right)\right.\nonumber\\
%&-\bm Y\otimes\left(\bm b\times\hat{\bm \xi}\right)\nonumber\\
%&-\frac{\left[\left(\bm b\times\bm Y\right)\cdot\hat{\bm \xi}\right]}{\bm Y\cdot \hat{\bm \xi}}\hat{\bm\xi}\otimes\bm z\nonumber\\
%&\left.\left.-\frac{\left[\left(\bm b\times\bm Y\right)\cdot\hat{\bm \xi}\right]}{2}\left(\bm I+2\frac{z+\bm Y\cdot \hat{\bm \xi}}{zY^2}\bm z\otimes\bm z+\frac{z}{\bm Y\cdot \hat{\bm \xi}}\hat{\bm\xi}\otimes\hat{\bm\xi}\right)\right\}\right]^{\bm z=d\left(\hat{\bm r}_c-\frac{L}{d}\hat{\bm\xi}\right)}_{\bm z=d\left(\hat{\bm r}_c+\frac{L}{d}\hat{\bm\xi}\right)}
%\end{align}
If $d$ is large compared to the segment length, that is 
\begin{align}
\frac{L}{d}\ll1
\end{align}
then the difference above can be approximated  as
\begin{align}
\bm s(\bm x)\approx \left.\frac{\partial \tilde {\bm s}(\bm z)}{\partial \bm z}\right|_{\bm z=\bm C-\bm x}\cdot(-2L\hat{\bm \xi})
%\left(d\left(\hat{\bm r}_c-\frac{L}{d}\hat{\bm\xi}\right)\right)-
%\tilde {\bm s}\left(d\left(\hat{\bm r}_c+\frac{L}{d}\hat{\bm\xi}\right)\right)
%\tilde {\bm s}(\bm A-\bm x)
\end{align}
Note that 
\begin{align}
\frac{\partial {Y_i}}{\partial z_j}\hat{\xi}_j=\frac{\bm Y\cdot\hat{\bm\xi}}{z}\hat{\xi}_i
\end{align}
then
\begin{align}
\frac{\partial \tilde {\bm s}(\bm z)}{\partial \bm z}
=\frac{\partial}{\partial \bm z}\left[\frac{2}{Y^2}\right.&
\left\{
(1-\nu)\hat{\bm\xi}\otimes\left(\bm b\times \bm Y\right)\right.\nonumber\\
&-\bm Y\otimes\left(\bm b\times\hat{\bm \xi}\right)\nonumber\\
&-\frac{\left[\left(\bm b\times\bm Y\right)\cdot\hat{\bm \xi}\right]}{\bm Y\cdot \hat{\bm \xi}}\hat{\bm\xi}\otimes\bm z\nonumber\\
&\left.\left.-\frac{\left[\left(\bm b\times\bm Y\right)\cdot\hat{\bm \xi}\right]}{2}\left(\bm I+2\frac{z+\bm Y\cdot \hat{\bm \xi}}{zY^2}\bm z\otimes\bm z+\frac{z}{\bm Y\cdot \hat{\bm \xi}}\hat{\bm\xi}\otimes\hat{\bm\xi}\right)\right\}\right]\cdot(-2L\hat{\bm \xi})\nonumber\\
%
&=\left[-\frac{2}{Y}\frac{\partial Y}{\partial \bm z}\cdot\left(-2L\hat{\bm \xi}\right)\right]\tilde{\bm s}(\bm z)\nonumber\\
&+\frac{2}{Y^2}\left[\frac{\partial}{\partial \bm z}
\left\{
(1-\nu)\hat{\bm\xi}\otimes\left(\bm b\times \bm Y\right)\right.\right.\nonumber\\
&-\bm Y\otimes\left(\bm b\times\hat{\bm \xi}\right)\nonumber\\
&-\frac{\left[\left(\bm b\times\bm Y\right)\cdot\hat{\bm \xi}\right]}{\bm Y\cdot \hat{\bm \xi}}\hat{\bm\xi}\otimes\bm z\nonumber\\
&\left.\left.-\frac{\left[\left(\bm b\times\bm Y\right)\cdot\hat{\bm \xi}\right]}{2}\left(\bm I+2\frac{z+\bm Y\cdot \hat{\bm \xi}}{zY^2}\bm z\otimes\bm z+\frac{z}{\bm Y\cdot \hat{\bm \xi}}\hat{\bm\xi}\otimes\hat{\bm\xi}\right)\right\}\right]\cdot(-2L\hat{\bm \xi})\nonumber\\
%
&=\frac{4L}{zY^2}\left(\bm Y\cdot\hat{\bm \xi}\right)^2\tilde{\bm s}(\bm z)\nonumber\\
&-\frac{4L}{Y^2}\left[
\left\{
(1-\nu)\frac{\bm Y\cdot\hat{\bm \xi}}{z}\hat{\bm\xi}\otimes\left(\bm b\times \hat{\bm \xi}\right)\right.\right.\nonumber\\
&-\frac{\bm Y\cdot\hat{\bm \xi}}{z}\hat{\bm \xi}\otimes\left(\bm b\times\hat{\bm \xi}\right)\nonumber\\
&+\frac{\left[\left(\bm b\times\bm Y\right)\cdot\hat{\bm \xi}\right]}{z\bm Y\cdot \hat{\bm \xi}}\hat{\bm\xi}\otimes\bm z
-\frac{\left[\left(\bm b\times\bm Y\right)\cdot\hat{\bm \xi}\right]}{\bm Y\cdot \hat{\bm \xi}}\hat{\bm\xi}\otimes\hat{\bm \xi}\nonumber\\
&\left.\left.-\left[\left(\bm b\times\bm Y\right)\cdot\hat{\bm \xi}\right]\left(\frac{z+\bm Y\cdot \hat{\bm \xi}}{zY^2}\bm z\otimes\bm z\right)\cdot\hat{\bm \xi}\right\}\right]\nonumber\\
&\left.\left.-\frac{\left[\left(\bm b\times\bm Y\right)\cdot\hat{\bm \xi}\right]}{2}\frac{\partial}{\partial \bm z}\left(\frac{z}{\bm Y\cdot \hat{\bm \xi}}\hat{\bm\xi}\otimes\hat{\bm\xi}\right)\cdot\hat{\bm \xi}\right\}\right]\nonumber\\
\end{align}

Now let $C$ be the center of the segment $\bm A\bm B$, so that  


\subsubsection{Stress of a straight segment in the neighborhood of a far point}

Suppose that we want to compute the stress field of segment $\bm A\bm B$ at a point $\bm x$ which is in the neighborhood of a point $\bm x_0$. Let the distance from $\bm x_0$ to the segment $\bm A\bm B$ be $d$. Then we work under the assumption $AB\ll d$ and $\|\bm x-\bm x_0\|\ll d$. 


%\begin{align}
%\bm s(\bm x)
%=&\left[\frac{2}{Y^2}\left\{(1-\nu)\hat{\bm\xi}\otimes\left(\bm b\times \bm Y\right)\right.\right.\nonumber\\
%&-\bm Y\otimes\left(\bm b\times\hat{\bm \xi}\right)\nonumber\\
%&-\frac{\left[\left(\bm b\times\bm Y\right)\cdot\hat{\bm \xi}\right]}{\bm Y\cdot \hat{\bm \xi}}\hat{\bm\xi}\otimes\bm z\nonumber\\
%&\left.\left.-\frac{\left[\left(\bm b\times\bm Y\right)\cdot\hat{\bm \xi}\right]}{2}\left(\bm I+2\frac{z+\bm Y\cdot \hat{\bm \xi}}{zY^2}\bm z\otimes\bm z+\frac{z\hat{\xi}_i\hat{\xi}_j}{\bm Y\cdot \hat{\bm \xi}}\right)\right\}\right]^{\bm z=\bm B-\bm x}_{\bm z=\bm A-\bm x}
%&\left.\left.-\epsilon_{klm}\hat{\xi}_lb_k\delta_{ij}\frac{2Y_m}{Y^2}\right\}\right]^{\bm z=\bm A-\bm x}_{\bm z=\bm B-\bm x}
%\end{align}

%$\rho_iY_j=(z_i-\bm z\cdot\hat{\bm \xi} \hat{\xi}_i)(z_j+z\hat{\xi}_j)=z_iz_j+zz_i\hat{\xi}_j-\bm z\cdot\hat{\bm \xi}\hat{\xi}_iz_j-z\bm z\cdot\hat{\bm \xi}\hat{\xi}_i\hat{\xi}_j$

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Straight Displacement}
\begin{align}
 u_i
 &=-\frac{ b_i\Omega}{4\pi}-b_k\hat{\xi}_lU_{ikl}\oint_\mathcal{L}R_adL'\nonumber\\
 &=-\frac{ b_i\Omega}{4\pi}-b_k\hat{\xi}_l\frac{1}{8\pi}\epsilon_{klm}\left[ \delta_{im}\Delta  -\frac{1}{1-\nu} \partial_i\partial_m  \right]\left[f(\bm B-\bm x)-f(\bm A-\bm x)\right)\nonumber\\
 &=-\frac{ b_i\Omega}{4\pi}-b_k\hat{\xi}_l\frac{1}{8\pi}\epsilon_{klm}\left[ \delta_{im}\frac{\partial^2f}{\partial z_p\partial z_p}  -\frac{1}{1-\nu} \frac{\partial^2 f}{\partial z_i\partial z_m}  \right]^{\bm z=\bm B-\bm x}_{\bm z=\bm A-\bm x}\nonumber\\
 &=-\frac{ b_i\Omega}{4\pi}+\epsilon_{ilk}\hat{\xi}_lb_k\frac{1}{8\pi}\left[ \frac{\partial^2f}{\partial z_p\partial z_p}\right]^{\bm z=\bm B-\bm x}_{\bm z=\bm A-\bm x}  +\frac{1}{8\pi}\frac{1}{1-\nu} \epsilon_{klm}b_k\hat{\xi}_l\left[\frac{\partial^2 f}{\partial z_i\partial z_m}  \right]^{\bm z=\bm B-\bm x}_{\bm z=\bm A-\bm x}
\end{align}
From Eq.~\eqref{laplacianFz}
\begin{align}
 u_i &=-\frac{ b_i\Omega}{4\pi}\nonumber\\
 &+\epsilon_{ilk}\hat{\xi}_lb_k\frac{1}{8\pi}\left[2+ 2\ln\left(\bm Y_a \cdot \hat{\bm \xi}\right)-\frac{a^2}{z_a \bm Y_a \cdot \hat{\bm \xi}}\right]^{\bm z=\bm B-\bm x}_{\bm z=\bm A-\bm x}  \nonumber\\
 &+\frac{1}{8\pi}\frac{1}{1-\nu} \epsilon_{klm}b_k\hat{\xi}_l\left[\frac{ \delta_{im}-\hat{\xi}_i\hat{\xi}_m}{2}
+ (\delta_{im}-\hat{\xi}_i\hat{\xi}_m)\ln\left(\bm Y_a \cdot \hat{\bm \xi}\right)
+ \frac{1}{ \bm Y_a \cdot \hat{\bm \xi}}\left(\frac{z_iz_m}{z_a}+z_i\hat{\xi}_m+z_m\hat{\xi}_i-z_q\hat{\xi}_q\hat{\xi}_i\hat{\xi}_m\right) \right]^{\bm z=\bm B-\bm x}_{\bm z=\bm A-\bm x}
\end{align}
Dropping vanishing terms of containing $\epsilon_{klm}b_k\hat{\xi}_l\hat{\xi}_m$
\begin{align}
 u_i &=-\frac{ b_i\Omega}{4\pi}\nonumber\\
 &+\epsilon_{ilk}\hat{\xi}_lb_k\frac{1}{8\pi}\left[2+ 2\ln\left(\bm Y_a \cdot \hat{\bm \xi}\right)-\frac{a^2}{z_a \bm Y_a \cdot \hat{\bm \xi}}\right]^{\bm z=\bm B-\bm x}_{\bm z=\bm A-\bm x}  \nonumber\\
 &+\frac{1}{8\pi}\frac{1}{1-\nu} \epsilon_{klm}b_k\hat{\xi}_l\left[\frac{ \delta_{im}}{2}
+ \delta_{im}\ln\left(\bm Y_a \cdot \hat{\bm \xi}\right)
+ \frac{1}{ \bm Y_a \cdot \hat{\bm \xi}}\left(\frac{z_iz_m}{z_a}+z_m\hat{\xi}_i\right) \right]^{\bm z=\bm B-\bm x}_{\bm z=\bm A-\bm x}
\end{align}
Factoring common terms
\begin{align}
 u_i &=-\frac{ b_i\Omega}{4\pi}\nonumber\\
 &-\epsilon_{ikl}b_k\hat{\xi}_l\frac{1}{8\pi}\left[2-\frac{1}{2}\frac{1}{1-\nu}+ \left(2-\frac{1}{1-\nu}\right)\ln\left(\bm Y_a \cdot \hat{\bm \xi}\right)-\frac{a^2}{z_a \bm Y_a \cdot \hat{\bm \xi}}
 \right]^{\bm z=\bm B-\bm x}_{\bm z=\bm A-\bm x}  \nonumber\\
 &+\frac{1}{8\pi}\frac{1}{1-\nu} \epsilon_{klm}b_k\hat{\xi}_l\left[
 \frac{z_m}{ \bm Y_a \cdot \hat{\bm \xi}}\frac{Y_{ai}}{z_a} \right]^{\bm z=\bm B-\bm x}_{\bm z=\bm A-\bm x}
\end{align}

\subsubsection{Straight Solid Angle}

\begin{align}
\Omega=-\oint\frac{\epsilon_{ijk}\hat{s}_jR_k}{R(R+\hat{s}_pR_p)}dL'_k
\end{align}
where $\bm R=\bm x-\bm x'$. We'll follow the integration method proposed by \cite{Asvestas:wt}. To do this we work with $\bm Y=-\bm R$ and $\hat{\bm Y}=\bm Y/Y$ to obtain  
\begin{align}
\Omega
=\oint\frac{\epsilon_{ijk}\hat{s}_jY_k}{Y(Y-\hat{s}_pY_p)}dL'_k
=\oint\frac{\epsilon_{ijk}\hat{s}_j\hat{Y}_k}{Y(1-\hat{s}_p\hat{Y}_p)}dL'_k
\end{align}
This integral can be evaluated by summing over straight segments. Each segment can be evaluated on unit sphere where $Y=1$, therefore
\begin{align}
\Omega_n=\int_0^{\alpha_n}\frac{\epsilon_{ijk}\hat{s}_j\hat{Y}_k}{(1-\hat{s}_p\hat{Y}_p)}\hat{t}'_kd\alpha
\end{align}
where $\cos\alpha_n=\bm Y_n\cdot \bm Y_{n+1}$.
If we let 
\begin{align}
\hat{\bm e}_1=\hat{\bm Y_n} && \hat{\bm e}_3=\frac{\hat{\bm Y}_n\times\hat{\bm Y}_{n+1}}{| \hat{\bm Y}_n\times\hat{\bm Y}_{n+1}|}  && \hat{\bm e}_2=\hat{\bm e}_3\times \hat{\bm e}_1
\end{align}
then
\begin{align}
\hat{\bm Y}(\alpha)&=\cos\alpha \, \hat{\bm e}_1+\sin \alpha \, \hat{\bm e}_2\\
\hat{\bm t}(\alpha)&=-\sin\alpha \, \hat{\bm e}_1+\cos \alpha \, \hat{\bm e}_2\\
\hat{\bm s}&=s_1 \hat{\bm e}_1+s_2 \hat{\bm e}_2+s_3 \hat{\bm e}_3
\end{align}
Substituting
\begin{align}
\Omega_n=\int_0^{\alpha_n}\frac{s_3}{1-s_1\cos\alpha-s_2\sin\alpha}d\alpha
\end{align}
This integral is evaluated using the transformation 
\begin{align}
\alpha =2\tan^{-1} w && \cos\alpha=\frac{1-w^2}{1+w^2} && \sin\alpha=\frac{2w}{1+w^2} && d\alpha=\frac{2dw}{1+w^2}
\end{align}
which gives
\begin{align}
\Omega_n
&=2s_3\int_0^{w^*}\frac{1}{1+w^2-s_1(1-w^2)-s_22w}d\alpha
=2s_3\int_0^{w^*}\frac{1}{(1+s_1)w^2-2s_2w+1-s_1}d\alpha\nonumber\\
&=2s_3\left[\frac{2}{\sqrt{4-4s_1^2-4s_2^2}}\tan^{-1}\left(\frac{2(1+s_1)w-2s_2}{\sqrt{4-4s_1^2-4s_2^2}}\right)\right]_0^{w^*}\nonumber\\
&=2\frac{s_3}{|s_3|}\left[\tan^{-1}\left(\frac{(1+s_1)w-s_2}{|s_3|}\right)\right]_0^{w^*}\nonumber\\
&=2\frac{s_3}{|s_3|}\tan^{-1}\left(\frac{\frac{(1+s_1)w^*-s_2}{|s_3|}+\frac{s_2}{|s_3|}}{1+\frac{(1+s_1)w^*-s_2}{|s_3|}\frac{-s_2}{|s_3|}}\right)\nonumber\\
&=2\frac{s_3}{|s_3|}\tan^{-1}\left(\frac{(1+s_1)w^*}{|s_3|-s_2\frac{(1+s_1)w^*-s_2}{|s_3|}}\right)\nonumber\\
&=2\frac{s_3}{|s_3|}\tan^{-1}\left(\frac{|s_3|(1+s_1)w^*}{s_3^2-s_2((1+s_1)w^*-s_2)}\right)\nonumber\\
&=2\frac{s_3}{|s_3|}\tan^{-1}\left(\frac{|s_3|w^*}{1-s_1-s_2w^*}\right)\nonumber\\
&=2\tan^{-1}\left(\frac{s_3w^*}{1-s_1-s_2w^*}\right)
\end{align}
where
\begin{align}
w^*=\sqrt{\frac{1-\bm Y_n\cdot \bm Y_{n+1}}{1+\bm Y_n\cdot \bm Y_{n+1}}}
\end{align}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{Non-singular Straight Solid Angle}
\begin{align}
\Omega=-\oint\frac{\epsilon_{ijk}\hat{s}_jR_k}{R_a(R_a+\hat{s}_pR_p)}dL'_k=\oint\frac{\epsilon_{ijk}\hat{s}_jY_k}{Y_a(Y_a-\hat{s}_pY_p)}dL'_k
\end{align}
If we now evaluate this expression on the unit sphere where $Y=1$ and $Y_a=\sqrt{1+a^2}$ we have
\begin{align}
\Omega_n=\int_0^{\alpha_n}\frac{\epsilon_{ijk}\hat{s}_j\hat{Y}_k}{\sqrt{1+a^2}(\sqrt{1+a^2}-\hat{s}_p\hat{Y}_p)}\hat{t}'_kd\alpha
\end{align}
We can then proceed as before and finally find
\begin{align}
\Omega_n
&=\frac{2}{\sqrt{1+a^2}\sqrt{s_3^2+a^2}}\tan^{-1}\left(\frac{\sqrt{s_3^2+a^2}w^*}{\sqrt{1+a^2}-s_1-s_2w^*}\right)
\end{align}

%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Force vector of a triangular element due to a straight segments}
We would like to compute the force vector of a triangular boundary element due to a straight segment. The weak form involved in the FEM problem is
\begin{align}
\int_\mathcal{T}\tilde u_i t_i \text{d}A=\sum_n \tilde u^n_i\int_\mathcal{T}N^n \sigma_{ij}\hat{n}_j \text{d}A
\end{align}
where $N^n$ is the shape function of the $n$-th node of the triangle, and $\tilde u^n_i$ its test displacement. Let us focus on the integral
\begin{align}
F^n_{ij}=\int_\mathcal{T}N^n(\bm x) \sigma_{ij}(\bm x) \text{d}A
=\int_\mathcal{T}N^n(\bm x) b_kS_{ijkl}\oint_\mathcal{L}R_a\ \text{d}\ell'_l\, \text{d}A
%=\int_\mathcal{T}N^n(\bm x) b_kS_{ijkl}\oint_\mathcal{L}R_a\ \text{d}\ell'_l\, \text{d}A
\end{align}


\begin{align}
\sigma_{ij}(\bm x)=b_kS_{ijkl}\oint_\mathcal{L}R_a\ d\ell'_l
\end{align}
For a straight segment starting at $\bm A$ and ending at $\bm B$
\begin{align}
\bm x'(u)=\bm A(1-u)+\bm Bu=\bm A+(\bm B-\bm A)u\hspace{1cm} u\in[0,1]
\end{align}






%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Plastic strain rate}

For conservative motion (glide) $\bm v\cdot\hat{\bm n}=0$, therefore, from (\ref{STT2L}):
\begin{align}
\dot\beta^p_{ij}(\bm x)=-b_i\int_{\bm A}^{\bm B}\delta(\bm x-\bm x')\epsilon_{jkm}v_kdl'_m
\end{align}


%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%
\appendix

\section{Kunin identity}
see Berdichevsky, Victor: Variational Principles of Continuum Mechanics: I. Fundamentals, 2009. p.239.
\begin{align}
\int\varphi(\bm x)e^{jkl}\frac{\partial}{\partial x_k}\int_\mathcal{S} \delta(\bm x-\bm x')\hat{n}_ldS'dV&=\int_\mathcal{S} \int\varphi(\bm x)e^{jkl}\frac{\partial}{\partial x_k}\delta(\bm x-\bm x')\hat{n}_ldVdS'\nonumber\\
&=-\int_\mathcal{S} \int\frac{\partial\varphi}{\partial x_k}(\bm x)e^{jkl}\delta(\bm x-\bm x')\hat{n}_ldVdS'\nonumber\\
&=-\int_\mathcal{S} \frac{\partial\varphi}{\partial x_k}(\bm x')e^{jkl}\hat{n}_ldS'\nonumber\\
\end{align}


%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%


\section{OLD}

Now, since 
\begin{align}
\delta(R)=-\frac{1}{4\pi}\nabla^2\left(\frac{1}{R}\right)=-\frac{1}{8\pi}\nabla^2(R_{,pp})=-\frac{1}{8\pi}R_{,ppqq}
\end{align}
then:
\begin{align}
\beta^p_{kl}(\bm x')=\frac{b_k}{8\pi}\int_\mathcal{S} R_{,ppqq}\hat{n}_ldS''
\label{plasticStrainRderivative}
\end{align}



Consider the derivative of the solid angle using eq.~(\ref{KelvinStokesCorollary})
\begin{align}
\Omega_{,j}=-\frac{1}{2}\int R_{,ppkj}\hat{n}_kdS&=-\frac{1}{2}\int R_{,ppkk}\hat{n}_jdS-\frac{1}{2}\oint\epsilon_{mkj}R_{,ppk}\xi_mdl
\end{align}
then, from eq.~(\ref{plasticStrainRderivative})
\begin{align}
-\frac{b_i}{4\pi}\Omega_{,j}&=\frac{b_i}{8\pi}\int R_{,ppkk}\hat{n}_jdS+\frac{b_i}{4\pi}\oint\epsilon_{kjm}R_{,ppk}\xi_mdl\nonumber\\
&=\beta^p_{ij}+\frac{b_i}{4\pi}\oint\epsilon_{kjm}R_{,ppk}\xi_mdl
\end{align}



%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%



\appendix
\section{Mathematical preliminaries}

\subsection{Kelvin-Stokes Theorem}
\begin{mytheorem} (Kelvin-Stokes Theorem)
\begin{align}
\int_\mathcal{S} \epsilon_{ikl}f_{,l}\hat{n}_kds=\oint_{\partial\mathcal{S}} f dl_i
\label{KelvinStokes}
\end{align}
\end{mytheorem}

\begin{mytheorem} (Corollary)
\begin{align}
\int_\mathcal{S} \left(f_{,q}\hat{n}_p-f_{,p}\hat{n}_q\right)ds=\oint_{\partial\mathcal{S}} \epsilon_{ipq}f dl_i
\label{KelvinStokesCorollary}
\end{align}
\end{mytheorem}


%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Surface Divergence Theorem}
In this section we recall some useful theorems in surface integration. \cite{Slattery2006}, \cite{Scovazzi2007}.

See \cite{Slattery:2006wn} p. 669.
\begin{mytheorem} (Surface Divergence Theorem)
fdsfsd
\end{mytheorem}

%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Surface Transport Theorem}

\begin{mytheorem} (Surface Transport Theorem)
\begin{align}
\frac{d}{dt}\int_{\mathcal{S}_x=\bm \varphi (\mathcal{S}_X)}\alpha \hat{n}_ids&=\int_{\mathcal{S}_x}\left(\frac{\partial \alpha}{\partial t}+\left(\alpha \dot \varphi_k\right)_{,k}\right)\hat{n}_ids-\int_{\mathcal{S}_x}\alpha \dot\varphi_{k,i}\hat{n}_kds
\label{STT2}
\end{align}
\end{mytheorem}

\begin{proof}
From \cite{Scovazzi:2007tc}.
\end{proof}


\begin{mytheorem} (Surface Transport Theorem (alternative form))
\begin{align}
\frac{d}{dt}\int_{\mathcal{S}_x}\alpha ds&=\int_{\mathcal{S}_x}\frac{\partial \alpha}{\partial t}\hat{n}_ids+\oint\epsilon_{ikm}\alpha v_k dl_m+\int_{\mathcal{S}_x}\alpha_{,i} v_{k}\hat{n}_kds
\label{STT2L}
\end{align}
\end{mytheorem}

\begin{proof}
Consider the second term on the r.h.s. of~\ref{STT2} and use (\ref{KelvinStokesCorollary}):
\begin{align}
\int_{\mathcal{S}_x}\left(\alpha \dot \varphi_k\right)_{,k}\hat{n}_ids&=
\int_{\mathcal{S}_x}\left(\alpha \dot \varphi_k\right)_{,i}\hat{n}_kds+\oint\epsilon_{mik}\alpha v_k dl_m
\nonumber\\
\end{align}
Now consider the third term on the r.h.s. of~\ref{STT2} 
\begin{align}
\int_{\mathcal{S}_x}\alpha \dot\varphi_{k,i}\hat{n}_kds=\int_{\mathcal{S}_x}\left(\alpha v_{k}\right)_{,i}\hat{n}_kds-\int_{\mathcal{S}_x}\alpha_{,i} v_{k}\hat{n}_kds
\end{align}
Subtract to obtain result
\end{proof}


\begin{mytheorem} (Surface Transport Theorem (alternative form))
\begin{align}
\frac{d}{dt}\int_{\mathcal{S}_x=\bm \varphi (\mathcal{S}_X)}\alpha ds&=
\label{STT1}
\end{align}
\end{mytheorem}

\begin{proof}
See  \cite{Slattery:2006wn} p 61.
\end{proof}


%%%%%%%%%%%%%%%%%%%%%%
\subsection{Solid angles and line integration}

\begin{mytheorem} (Surface to Line integration)
Let $\mathcal{S}$ be a surface bounded by the closed contour $\Gamma$. Then let $\bm R=\bm R_s-\bm R_f$ where $\bm R_f$ is the field point and $\bm R_s$ is the source point on $\mathcal{S}$. If $\bm s$ is a unit vector applied at $\bm R_f$ such that the direction containing it never intersects $\mathcal{S}$ nor $\Gamma$, then: 
\begin{align}
-\int\frac{\bm R}{R^3} \cdot\hat{n}dS=\oint\frac{\bm s\times\bm R}{R(R-\bm s\cdot\bm R)}\cdot d\bm l
\label{solidAngle2Line}
\end{align}
Obviously if $\bm R$ has opposite definition, i.e. $\bm R=\bm R_f-\bm R_s$ then
\begin{align}
\int\frac{\bm R}{R^3} \cdot\hat{n}dS=-\oint\frac{\bm s\times\bm R}{R(R+\bm s\cdot\bm R)}\cdot d\bm l
\label{solidAngle2Line2}
\end{align}

\end{mytheorem}



Note that for unit vector $\bm s$ we have $\left(\bm R-R\bm s\right)^2=R^2+R^2-2R\bm R\cdot\bm s=2R(R-\bm R\cdot\bm s)$. This means that $2R(R-\bm R\cdot\bm s)=0$ only when $\bm R$ is aligned with $\bm s$.

\begin{proof}
From Stokes theorem:
\begin{align}
\oint\frac{\bm s\times\bm R}{R(R-\bm s\cdot\bm R)}\cdot d\bm l=\int\nabla\times\left[\frac{\bm s\times\bm R}{R(R-\bm s\cdot\bm R)}\right]ds
\end{align}
Now exapand the curl
\begin{align}
\nabla\times\left[\frac{\bm s\times\bm R}{R(R-\bm s\cdot\bm R)}\right]&=\epsilon_{ijk}\partial_j\left[\frac{\epsilon_{kmn}s_mR_n}{R(R-s_pR_p)}\right]=\left(\delta_{im}\delta_{jn}-\delta_{in}\delta_{jm}\right)\partial_j\left[\frac{s_mR_n}{R(R-s_pR_p)}\right]\nonumber\\
&=\left(\delta_{im}\delta_{jn}-\delta_{in}\delta_{jm}\right)\left[\frac{s_mR_{n,j}}{R(R-s_pR_p)}-\frac{s_mR_{n}\left[R_{,j}(R-s_pR_p)+R(R_{,j}-s_pR_{p,j})\right]}{R^2(R-s_pR_p)^2}\right]\nonumber\\
&=\left(\delta_{im}\delta_{jn}-\delta_{in}\delta_{jm}\right)\left[\frac{s_m\delta_{nj}}{R(R-s_pR_p)}-\frac{s_mR_{n}\left[\frac{R_j}{R}(R-s_pR_p)+R(\frac{R_j}{R}-s_p\delta_{pj})\right]}{R^2(R-s_pR_p)^2}\right]\nonumber\\
&=\left(\delta_{im}\delta_{jn}-\delta_{in}\delta_{jm}\right)\left[\frac{s_m\delta_{nj}}{R(R-s_pR_p)}-\frac{s_mR_{n}\left[\frac{R_j}{R}(R-s_pR_p)+(R_j-Rs_j)\right]}{R^2(R-s_pR_p)^2}\right]\nonumber\\
&=\left[\frac{\delta_{im}\delta_{jn}s_m\delta_{nj}}{R(R-s_pR_p)}-\frac{\delta_{im}\delta_{jn}s_mR_{n}\left[\frac{R_j}{R}(R-s_pR_p)+(R_j-Rs_j)\right]}{R^2(R-s_pR_p)^2}\right]\nonumber\\
&-\left[\frac{\delta_{in}\delta_{jm}s_m\delta_{nj}}{R(R-s_pR_p)}-\frac{\delta_{in}\delta_{jm}s_mR_{n}\left[\frac{R_j}{R}(R-s_pR_p)+(R_j-Rs_j)\right]}{R^2(R-s_pR_p)^2}\right]\nonumber\\
&=\left[\frac{3s_i}{R(R-s_pR_p)}-\frac{s_i\left[R(R-s_pR_p)+R(R-R_{j}s_j)\right]}{R^2(R-s_pR_p)^2}\right]\nonumber\\
&-\left[\frac{s_i}{R(R-s_pR_p)}-\frac{R_{i}\left[\frac{R_js_j}{R}(R-s_pR_p)+(R_js_j-R)\right]}{R^2(R-s_pR_p)^2}\right]\nonumber\\
&=\frac{3s_i}{R(R-s_pR_p)}-\frac{2s_i}{R(R-s_pR_p)}\nonumber\\
&-\frac{s_i}{R(R-s_pR_p)}+R_{i}\frac{\left[-R-\frac{R_js_js_pR_p}{R}+2R_js_j\right]}{R^2(R^2+s_pR_ps_jR_j-2Rs_pR_p)}\nonumber\\
&=-\frac{R_i}{R^3}
\end{align}
\end{proof}

   
   

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{OLD NOTES: Elastic Energy of a Dislocation Loop}
\subsection{Volume to Surface}
(Eshelby) Let's consider a body delimited by a closed surface $S_0$ having a source of eigenstress\footnote{ no external surface traction}  $I$ enclosed within the surface $S$ and a source of stress $II$ outside $S$.

%and $V_I$ be a volume enclosing source $I$ then

\begin{eqnarray}
E&=&\frac{1}{2}\int_V\sigma_{ij}\epsilon_{ij}dV=\frac{1}{2}\int_V\left(\sigma^I_{ij}+\sigma^{II}_{ij}\right)\left(\epsilon^I_{ij}+\epsilon^{II}_{ij}\right)dV\nonumber\\
&=&\frac{1}{2}\int_V\sigma^I_{ij}\epsilon^{I}_{ij}dV+\frac{1}{2}\int_V\sigma^{II}_{ij}\epsilon^{II}_{ij}dV+\underbrace{\frac{1}{2}\int_V\sigma^{I}_{ij}\epsilon^{II}_{ij}dV+\frac{1}{2}\int_V\sigma^{II}_{ij}\epsilon^{I}_{ij}dV}_{\mbox{equal for reciprocity theorem}}\nonumber\\
&=&\underbrace{\frac{1}{2}\int_V\sigma^I_{ij}\epsilon^{I}_{ij}dV}_{E_I}+\underbrace{\frac{1}{2}\int_V\sigma^{II}_{ij}\epsilon^{II}_{ij}dV}_{E_{II}}+\underbrace{\int_V\sigma^{I}_{ij}\epsilon^{II}_{ij}dV}_{E_{int}}
\end{eqnarray}
Away from their respective sources strains are gradients of displacement fields therefore $\epsilon^{I}_{ij}=\frac{1}{2}\left(u^I_{i,j}+u^I_{j,i}\right)$ in $V_{II}$ and $\epsilon^{II}_{ij}=\frac{1}{2}\left(u^{II}_{i,j}+u^{II}_{j,i}\right)$ in $V_{I}$, but not conversely.
\begin{eqnarray}
E_{int}&=&\int_{V_I}\sigma^{I}_{ij}u^{II}_{i,j}dV_I+\int_{V_{II}}\sigma^{II}_{ij}u^{I}_{i,j}dV_{II}\noindent\\
&=&\oint_{S}\sigma^{I}_{ij}u^{II}_{i}\hat{n}_jdS-\underbrace{\int_{V_I}\sigma^{I}_{i,j}u^{II}_{i}dV_I}_{\mbox{equilibrium}}\nonumber\\
&+&\oint_{S_0}\sigma^{II}_{ij}u^{I}_{i}\hat{n}_jdS-\oint_{S}\sigma^{II}_{ij}u^{I}_{i}\hat{n}_jdS+\underbrace{\int_{V_{II}}\sigma^{II}_{i,j}u^{I}_{i}dV_{II}}_{\mbox{equilibrium}}\nonumber\\
&=&\oint_{S}\left(\sigma^{I}_{ij}u^{II}_{i}-\sigma^{II}_{ij}u^{I}_{i}\right)\hat{n}_jdS+\underbrace{\oint_{S_0}t_i^{II}u_i^{I}dS}_{\mbox{no surface tractions}}
\end{eqnarray}


the end result is

\begin{equation}
E_{int}=b_i\int_\mathcal{S} \sigma^{II}_{ij}\hat{n}_jdS
\end{equation}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\bibliographystyle{chicago} % authors sorted alphabetically
%\bibliography{references}

%\begin{thebibliography}{99}

%\bibitem{Slattery2006} Slattery, J. C., Sagis, L.,  Oh, E.-S. (2006). Interfacial Transport Phenomena, 2nd ed., Springer.

%
%\bibitem{Scovazzi2007} Scovazzi, G., Hughes, T. J. R. (2007). Lecture Notes on Continuum Mechanics on Arbitrary Moving Domains. cs.sandia.gov.





%\end{thebibliography}

\input{tex/appendices}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\bibliographystyle{plainnat}
\bibliography{references_GP,references_GP2,references_GP3,references_ML,references_NA,references_NG2,references_MM,references_tamer}

\end{document}













